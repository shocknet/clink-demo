/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={44:(t,e)=>{const n="[0-9]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+")(?:.|[\r\n]))+";e.KANJI=new RegExp(r,"g"),e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),e.BYTE=new RegExp(o,"g"),e.NUMERIC=new RegExp(n,"g"),e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const i=new RegExp("^"+r+"$"),s=new RegExp("^"+n+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");e.testKanji=function(t){return i.test(t)},e.testNumeric=function(t){return s.test(t)},e.testAlphanumeric=function(t){return a.test(t)}},157:(t,e,n)=>{const r=n(886),o=n(953),i=n(899),s=n(820),a=n(421),c=n(756),u=n(332),l=n(518),f=n(764),h=n(427),d=n(565),g=n(208),p=n(801);function y(t,e,n){const r=t.size,o=d.getEncodedBits(e,n);let i,s;for(i=0;i<15;i++)s=1==(o>>i&1),i<6?t.set(i,8,s,!0):i<8?t.set(i+1,8,s,!0):t.set(r-15+i,8,s,!0),i<8?t.set(8,r-i-1,s,!0):i<9?t.set(8,15-i-1+1,s,!0):t.set(8,15-i-1,s,!0);t.set(r-8,8,1,!0)}function w(t,e,n,o){let d;if(Array.isArray(t))d=p.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");{let r=e;if(!r){const e=p.rawSplit(t);r=h.getBestVersionForData(e,n)}d=p.fromString(t,r||40)}}const w=h.getBestVersionForData(d,n);if(!w)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<w)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+w+".\n")}else e=w;const m=function(t,e,n){const o=new i;n.forEach(function(e){o.put(e.mode.bit,4),o.put(e.getLength(),g.getCharCountIndicator(e.mode,t)),e.write(o)});const s=8*(r.getSymbolTotalCodewords(t)-l.getTotalCodewordsCount(t,e));for(o.getLengthInBits()+4<=s&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(0);const a=(s-o.getLengthInBits())/8;for(let t=0;t<a;t++)o.put(t%2?17:236,8);return function(t,e,n){const o=r.getSymbolTotalCodewords(e),i=o-l.getTotalCodewordsCount(e,n),s=l.getBlocksCount(e,n),a=s-o%s,c=Math.floor(o/s),u=Math.floor(i/s),h=u+1,d=c-u,g=new f(d);let p=0;const y=new Array(s),w=new Array(s);let m=0;const b=new Uint8Array(t.buffer);for(let t=0;t<s;t++){const e=t<a?u:h;y[t]=b.slice(p,p+e),w[t]=g.encode(y[t]),p+=e,m=Math.max(m,e)}const E=new Uint8Array(o);let v,x,A=0;for(v=0;v<m;v++)for(x=0;x<s;x++)v<y[x].length&&(E[A++]=y[x][v]);for(v=0;v<d;v++)for(x=0;x<s;x++)E[A++]=w[x][v];return E}(o,t,e)}(e,n,d),b=r.getSymbolSize(e),E=new s(b);return function(t,e){const n=t.size,r=c.getPositions(e);for(let e=0;e<r.length;e++){const o=r[e][0],i=r[e][1];for(let e=-1;e<=7;e++)if(!(o+e<=-1||n<=o+e))for(let r=-1;r<=7;r++)i+r<=-1||n<=i+r||(e>=0&&e<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===e||6===e)||e>=2&&e<=4&&r>=2&&r<=4?t.set(o+e,i+r,!0,!0):t.set(o+e,i+r,!1,!0))}}(E,e),function(t){const e=t.size;for(let n=8;n<e-8;n++){const e=n%2==0;t.set(n,6,e,!0),t.set(6,n,e,!0)}}(E),function(t,e){const n=a.getPositions(e);for(let e=0;e<n.length;e++){const r=n[e][0],o=n[e][1];for(let e=-2;e<=2;e++)for(let n=-2;n<=2;n++)-2===e||2===e||-2===n||2===n||0===e&&0===n?t.set(r+e,o+n,!0,!0):t.set(r+e,o+n,!1,!0)}}(E,e),y(E,n,0),e>=7&&function(t,e){const n=t.size,r=h.getEncodedBits(e);let o,i,s;for(let e=0;e<18;e++)o=Math.floor(e/3),i=e%3+n-8-3,s=1==(r>>e&1),t.set(o,i,s,!0),t.set(i,o,s,!0)}(E,e),function(t,e){const n=t.size;let r=-1,o=n-1,i=7,s=0;for(let a=n-1;a>0;a-=2)for(6===a&&a--;;){for(let n=0;n<2;n++)if(!t.isReserved(o,a-n)){let r=!1;s<e.length&&(r=1==(e[s]>>>i&1)),t.set(o,a-n,r),i--,-1===i&&(s++,i=7)}if(o+=r,o<0||n<=o){o-=r,r=-r;break}}}(E,m),isNaN(o)&&(o=u.getBestMask(E,y.bind(null,E,n))),u.applyMask(o,E),y(E,n,o),{modules:E,version:e,errorCorrectionLevel:n,maskPattern:o,segments:d}}e.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");let n,i,s=o.M;return void 0!==e&&(s=o.from(e.errorCorrectionLevel,o.M),n=h.from(e.version),i=u.from(e.maskPattern),e.toSJISFunc&&r.setToSJISFunction(e.toSJISFunc)),w(t,n,s,i)}},185:(t,e,n)=>{"use strict";n.d(e,{c:()=>o});var r=n(938);const o=function(){const t=localStorage.getItem("clink-demo-privateKey");if(t)return new Uint8Array(t.split(",").map(Number));{const t=(0,r.Bq)();return localStorage.setItem("clink-demo-privateKey",t.toString()),t}}()},208:(t,e,n)=>{const r=n(878),o=n(44);e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!r.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return o.testNumeric(t)?e.NUMERIC:o.testAlphanumeric(t)?e.ALPHANUMERIC:o.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return n}}},235:(t,e,n)=>{"use strict";n.d(e,{u2:()=>u});var r=n(986);const{getConversationKey:o,decrypt:i}=r.Q5,s=(t,e,n)=>({since:Math.floor(Date.now()/1e3)-1,kinds:[n],"#p":[t],"#e":[e]}),{getConversationKey:a,encrypt:c}=r.Q5,u=async(t,e,n,u,f,h=30,d)=>{const g=(0,r.lG)(e),p=c(JSON.stringify(f),a(e,u));return(async(t,e,n,a,c,u,l,f)=>{const h=(0,r.pC)(c,e.privateKey);return await Promise.all(t.publish(n,h)),new Promise((r,c)=>{let u=!1,d={close:()=>{}},g=null;l&&(g=setTimeout(()=>{d.close(),c("failed to get ndebit response in time")},1e3*l)),d=t.subscribeMany(n,[s(e.publicKey,h.id,21001)],{onevent:async t=>{g&&clearTimeout(g);const n=i(t.content,o(e.privateKey,a));u?f?.(JSON.parse(n)):(u=!0,r(JSON.parse(n)))}})})})(t,{privateKey:e,publicKey:g},n,u,l(p,g,u),0,h,d)},l=(t,e,n)=>({content:t,created_at:Math.floor(Date.now()/1e3),kind:21001,pubkey:e,tags:[["p",n],["clink_version","1"]]})},280:(t,e,n)=>{const r=n(726);e.render=function(t,e,n){let o=n,i=e;void 0!==o||e&&e.getContext||(o=e,e=void 0),e||(i=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),o=r.getOptions(o);const s=r.getImageWidth(t.modules.size,o),a=i.getContext("2d"),c=a.createImageData(s,s);return r.qrToImageData(c.data,t,o),function(t,e,n){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=n,e.width=n,e.style.height=n+"px",e.style.width=n+"px"}(a,i,s),a.putImageData(c,0,0),i},e.renderToDataURL=function(t,n,r){let o=r;void 0!==o||n&&n.getContext||(o=n,n=void 0),o||(o={});const i=e.render(t,n,o),s=o.type||"image/png",a=o.rendererOpts||{};return i.toDataURL(s,a.quality)}},320:t=>{"use strict";var e={single_source_shortest_paths:function(t,n,r){var o={},i={};i[n]=0;var s,a,c,u,l,f,h,d=e.PriorityQueue.make();for(d.push(n,0);!d.empty();)for(c in a=(s=d.pop()).value,u=s.cost,l=t[a]||{})l.hasOwnProperty(c)&&(f=u+l[c],h=i[c],(void 0===i[c]||h>f)&&(i[c]=f,d.push(c,f),o[c]=a));if(void 0!==r&&void 0===i[r]){var g=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(g)}return o},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),t[r],r=t[r];return n.reverse(),n},find_path:function(t,n,r){var o=e.single_source_shortest_paths(t,n,r);return e.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(t){var n,r=e.PriorityQueue,o={};for(n in t=t||{},r)r.hasOwnProperty(n)&&(o[n]=r[n]);return o.queue=[],o.sorter=t.sorter||r.default_sorter,o},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var n={value:t,cost:e};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e},324:(t,e,n)=>{"use strict";function r(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function o(t,...e){if(!r(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function i(t,e){return!!Array.isArray(e)&&(0===e.length||(t?e.every(t=>"string"==typeof t):e.every(t=>Number.isSafeInteger(t))))}function s(t){if("function"!=typeof t)throw new Error("function expected");return!0}function a(t,e){if("string"!=typeof e)throw new Error(`${t}: string expected`);return!0}function c(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function u(t){if(!Array.isArray(t))throw new Error("array expected")}function l(t,e){if(!i(!0,e))throw new Error(`${t}: array of strings expected`)}function f(t,e){if(!i(!1,e))throw new Error(`${t}: array of numbers expected`)}function h(...t){const e=t=>t,n=(t,e)=>n=>t(e(n));return{encode:t.map(t=>t.encode).reduceRight(n,e),decode:t.map(t=>t.decode).reduce(n,e)}}function d(t){const e="string"==typeof t?t.split(""):t,n=e.length;l("alphabet",e);const r=new Map(e.map((t,e)=>[t,e]));return{encode:r=>(u(r),r.map(r=>{if(!Number.isSafeInteger(r)||r<0||r>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${r}". Allowed: ${t}`);return e[r]})),decode:e=>(u(e),e.map(e=>{a("alphabet.decode",e);const n=r.get(e);if(void 0===n)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return n}))}}function g(t=""){return a("join",t),{encode:e=>(l("join.decode",e),e.join(t)),decode:e=>(a("join.decode",e),e.split(t))}}function p(t,e="="){return c(t),a("padding",e),{encode(n){for(l("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){l("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8==0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function y(t){return s(t),{encode:t=>t,decode:e=>t(e)}}function w(t,e,n){if(e<2)throw new Error(`convertRadix: invalid from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(u(t),!t.length)return[];let r=0;const o=[],i=Array.from(t,t=>{if(c(t),t<0||t>=e)throw new Error(`invalid integer: ${t}`);return t}),s=i.length;for(;;){let t=0,a=!0;for(let o=r;o<s;o++){const s=i[o],c=e*t,u=c+s;if(!Number.isSafeInteger(u)||c/e!==t||u-s!==c)throw new Error("convertRadix: carry overflow");const l=u/n;t=u%n;const f=Math.floor(l);if(i[o]=f,!Number.isSafeInteger(f)||f*n+t!==u)throw new Error("convertRadix: carry overflow");a&&(f?a=!1:r=o)}if(o.push(t),a)break}for(let e=0;e<t.length-1&&0===t[e];e++)o.push(0);return o.reverse()}n.d(e,{I:()=>R});const m=(t,e)=>0===e?t:m(e,t%e),b=(t,e)=>t+(e-m(t,e)),E=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function v(t,e,n,r){if(u(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(b(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${b(e,n)}`);let o=0,i=0;const s=E[e],a=E[n]-1,l=[];for(const r of t){if(c(r),r>=s)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(o=o<<e|r,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)l.push((o>>i-n&a)>>>0);const t=E[i];if(void 0===t)throw new Error("invalid carry");o&=t-1}if(o=o<<n-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&l.push(o>>>0),l}function x(t,e=!1){if(c(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(b(8,t)>32||b(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!r(n))throw new Error("radix2.encode input should be Uint8Array");return v(Array.from(n),8,t,!e)},decode:n=>(f("radix2.decode",n),Uint8Array.from(v(n,t,8,e)))}}function A(t){return s(t),function(...e){try{return t.apply(null,e)}catch(t){}}}h(x(4),d("0123456789ABCDEF"),g("")),h(x(5),d("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),p(5),g(""));const I=(h(x(5),d("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),g("")),h(x(5),d("0123456789ABCDEFGHIJKLMNOPQRSTUV"),p(5),g("")),h(x(5),d("0123456789ABCDEFGHIJKLMNOPQRSTUV"),g("")),h(x(5),d("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),g(""),y(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),(()=>"function"==typeof Uint8Array.from([]).toBase64&&"function"==typeof Uint8Array.fromBase64)()),B=(t,e)=>{a("base64",t);const n=e?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/,r=e?"base64url":"base64";if(t.length>0&&!n.test(t))throw new Error("invalid base64");return Uint8Array.fromBase64(t,{alphabet:r,lastChunkHandling:"strict"})},S=(I||h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),p(6),g("")),h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),g("")),I||h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),p(6),g("")),h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),g("")),t=>{return h((c(e=58),{encode:t=>{if(!r(t))throw new Error("radix.encode input should be Uint8Array");return w(Array.from(t),256,e)},decode:t=>(f("radix.decode",t),Uint8Array.from(w(t,e,256)))}),d(t),g(""));var e}),k=(S("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),S("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),S("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),h(d("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),g(""))),U=[996825010,642813549,513874426,1027748829,705979059];function L(t){const e=t>>25;let n=(33554431&t)<<5;for(let t=0;t<U.length;t++)1==(e>>t&1)&&(n^=U[t]);return n}function T(t,e,n=1){const r=t.length;let o=1;for(let e=0;e<r;e++){const n=t.charCodeAt(e);if(n<33||n>126)throw new Error(`Invalid prefix (${t})`);o=L(o)^n>>5}o=L(o);for(let e=0;e<r;e++)o=L(o)^31&t.charCodeAt(e);for(let t of e)o=L(o)^t;for(let t=0;t<6;t++)o=L(o);return o^=n,k.encode(v([o%E[30]],30,5,!1))}function C(t){const e="bech32"===t?1:734539939,n=x(5),o=n.decode,i=n.encode,s=A(o);function c(t,n,o=90){a("bech32.encode prefix",t),r(n)&&(n=Array.from(n)),f("bech32.encode",n);const i=t.length;if(0===i)throw new TypeError(`Invalid prefix length ${i}`);const s=i+7+n.length;if(!1!==o&&s>o)throw new TypeError(`Length ${s} exceeds limit ${o}`);const c=t.toLowerCase(),u=T(c,n,e);return`${c}1${k.encode(n)}${u}`}function u(t,n=90){a("bech32.decode input",t);const r=t.length;if(r<8||!1!==n&&r>n)throw new TypeError(`invalid string length: ${r} (${t}). Expected (8..${n})`);const o=t.toLowerCase();if(t!==o&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const i=o.lastIndexOf("1");if(0===i||-1===i)throw new Error('Letter "1" must be present between prefix and data only');const s=o.slice(0,i),c=o.slice(i+1);if(c.length<6)throw new Error("Data must be at least 6 characters long");const u=k.decode(c).slice(0,-6),l=T(s,u,e);if(!c.endsWith(l))throw new Error(`Invalid checksum in ${t}: expected "${l}"`);return{prefix:s,words:u}}return{encode:c,decode:u,encodeFromBytes:function(t,e){return c(t,i(e))},decodeToBytes:function(t){const{prefix:e,words:n}=u(t,!1);return{prefix:e,words:n,bytes:o(n)}},decodeUnsafe:A(u),fromWords:o,fromWordsUnsafe:s,toWords:i}}const R=C("bech32");C("bech32m");(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)()||h(x(4),d("0123456789abcdef"),g(""),y(t=>{if("string"!=typeof t||t.length%2!=0)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}))},332:(t,e)=>{e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function n(t,n,r){switch(t){case e.Patterns.PATTERN000:return(n+r)%2==0;case e.Patterns.PATTERN001:return n%2==0;case e.Patterns.PATTERN010:return r%3==0;case e.Patterns.PATTERN011:return(n+r)%3==0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case e.Patterns.PATTERN101:return n*r%2+n*r%3==0;case e.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case e.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){const e=t.size;let n=0,r=0,o=0,i=null,s=null;for(let a=0;a<e;a++){r=o=0,i=s=null;for(let c=0;c<e;c++){let e=t.get(a,c);e===i?r++:(r>=5&&(n+=r-5+3),i=e,r=1),e=t.get(c,a),e===s?o++:(o>=5&&(n+=o-5+3),s=e,o=1)}r>=5&&(n+=r-5+3),o>=5&&(n+=o-5+3)}return n},e.getPenaltyN2=function(t){const e=t.size;let n=0;for(let r=0;r<e-1;r++)for(let o=0;o<e-1;o++){const e=t.get(r,o)+t.get(r,o+1)+t.get(r+1,o)+t.get(r+1,o+1);4!==e&&0!==e||n++}return 3*n},e.getPenaltyN3=function(t){const e=t.size;let n=0,r=0,o=0;for(let i=0;i<e;i++){r=o=0;for(let s=0;s<e;s++)r=r<<1&2047|t.get(i,s),s>=10&&(1488===r||93===r)&&n++,o=o<<1&2047|t.get(s,i),s>=10&&(1488===o||93===o)&&n++}return 40*n},e.getPenaltyN4=function(t){let e=0;const n=t.data.length;for(let r=0;r<n;r++)e+=t.data[r];return 10*Math.abs(Math.ceil(100*e/n/5)-10)},e.applyMask=function(t,e){const r=e.size;for(let o=0;o<r;o++)for(let i=0;i<r;i++)e.isReserved(i,o)||e.xor(i,o,n(t,i,o))},e.getBestMask=function(t,n){const r=Object.keys(e.Patterns).length;let o=0,i=1/0;for(let s=0;s<r;s++){n(s),e.applyMask(s,t);const r=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),r<i&&(i=r,o=s)}return o}},333:t=>{t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},357:(t,e,n)=>{const r=n(208);function o(t){this.mode=r.NUMERIC,this.data=t.toString()}o.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){let e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);const o=this.data.length-e;o>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*o+1))},t.exports=o},375:(t,e,n)=>{const r=n(726);function o(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function i(t,e,n){let r=t+e;return void 0!==n&&(r+=" "+n),r}e.render=function(t,e,n){const s=r.getOptions(e),a=t.modules.size,c=t.modules.data,u=a+2*s.margin,l=s.color.light.a?"<path "+o(s.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",f="<path "+o(s.color.dark,"stroke")+' d="'+function(t,e,n){let r="",o=0,s=!1,a=0;for(let c=0;c<t.length;c++){const u=Math.floor(c%e),l=Math.floor(c/e);u||s||(s=!0),t[c]?(a++,c>0&&u>0&&t[c-1]||(r+=s?i("M",u+n,.5+l+n):i("m",o,0),o=0,s=!1),u+1<e&&t[c+1]||(r+=i("h",a),a=0)):o++}return r}(c,a,s.margin)+'"/>',h='viewBox="0 0 '+u+" "+u+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+h+' shape-rendering="crispEdges">'+l+f+"</svg>\n";return"function"==typeof n&&n(null,d),d}},421:(t,e,n)=>{const r=n(886).getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];const e=Math.floor(t/7)+2,n=r(t),o=145===n?26:2*Math.ceil((n-13)/(2*e-2)),i=[n-7];for(let t=1;t<e-1;t++)i[t]=i[t-1]-o;return i.push(6),i.reverse()},e.getPositions=function(t){const n=[],r=e.getRowColCoords(t),o=r.length;for(let t=0;t<o;t++)for(let e=0;e<o;e++)0===t&&0===e||0===t&&e===o-1||t===o-1&&0===e||n.push([r[t],r[e]]);return n}},427:(t,e,n)=>{const r=n(886),o=n(518),i=n(953),s=n(208),a=n(878),c=r.getBCHDigit(7973);function u(t,e){return s.getCharCountIndicator(t,e)+4}function l(t,e){let n=0;return t.forEach(function(t){const r=u(t.mode,e);n+=r+t.getBitsLength()}),n}e.from=function(t,e){return a.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,n){if(!a.isValid(t))throw new Error("Invalid QR Code version");void 0===n&&(n=s.BYTE);const i=8*(r.getSymbolTotalCodewords(t)-o.getTotalCodewordsCount(t,e));if(n===s.MIXED)return i;const c=i-u(n,t);switch(n){case s.NUMERIC:return Math.floor(c/10*3);case s.ALPHANUMERIC:return Math.floor(c/11*2);case s.KANJI:return Math.floor(c/13);case s.BYTE:default:return Math.floor(c/8)}},e.getBestVersionForData=function(t,n){let r;const o=i.from(n,i.M);if(Array.isArray(t)){if(t.length>1)return function(t,n){for(let r=1;r<=40;r++)if(l(t,r)<=e.getCapacity(r,n,s.MIXED))return r}(t,o);if(0===t.length)return 1;r=t[0]}else r=t;return function(t,n,r){for(let o=1;o<=40;o++)if(n<=e.getCapacity(o,r,t))return o}(r.mode,r.getLength(),o)},e.getEncodedBits=function(t){if(!a.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;r.getBCHDigit(e)-c>=0;)e^=7973<<r.getBCHDigit(e)-c;return t<<12|e}},433:(t,e,n)=>{const r=n(208),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(t){this.mode=r.ALPHANUMERIC,this.data=t}i.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=45*o.indexOf(this.data[e]);n+=o.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(o.indexOf(this.data[e]),6)},t.exports=i},518:(t,e,n)=>{const r=n(953),o=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];e.getBlocksCount=function(t,e){switch(e){case r.L:return o[4*(t-1)+0];case r.M:return o[4*(t-1)+1];case r.Q:return o[4*(t-1)+2];case r.H:return o[4*(t-1)+3];default:return}},e.getTotalCodewordsCount=function(t,e){switch(e){case r.L:return i[4*(t-1)+0];case r.M:return i[4*(t-1)+1];case r.Q:return i[4*(t-1)+2];case r.H:return i[4*(t-1)+3];default:return}}},565:(t,e,n)=>{const r=n(886),o=r.getBCHDigit(1335);e.getEncodedBits=function(t,e){const n=t.bit<<3|e;let i=n<<10;for(;r.getBCHDigit(i)-o>=0;)i^=1335<<r.getBCHDigit(i)-o;return 21522^(n<<10|i)}},583:(t,e,n)=>{const r=n(333),o=n(157),i=n(280),s=n(375);function a(t,e,n,i,s){const a=[].slice.call(arguments,1),c=a.length,u="function"==typeof a[c-1];if(!u&&!r())throw new Error("Callback required as last argument");if(!u){if(c<1)throw new Error("Too few arguments provided");return 1===c?(n=e,e=i=void 0):2!==c||e.getContext||(i=n,n=e,e=void 0),new Promise(function(r,s){try{const s=o.create(n,i);r(t(s,e,i))}catch(t){s(t)}})}if(c<2)throw new Error("Too few arguments provided");2===c?(s=n,n=e,e=i=void 0):3===c&&(e.getContext&&void 0===s?(s=i,i=void 0):(s=i,i=n,n=e,e=void 0));try{const r=o.create(n,i);s(null,t(r,e,i))}catch(t){s(t)}}e.create=o.create,e.toCanvas=a.bind(null,i.render),e.toDataURL=a.bind(null,i.renderToDataURL),e.toString=a.bind(null,function(t,e,n){return s.render(t,n)})},713:(t,e,n)=>{const r=n(731);e.mul=function(t,e){const n=new Uint8Array(t.length+e.length-1);for(let o=0;o<t.length;o++)for(let i=0;i<e.length;i++)n[o+i]^=r.mul(t[o],e[i]);return n},e.mod=function(t,e){let n=new Uint8Array(t);for(;n.length-e.length>=0;){const t=n[0];for(let o=0;o<e.length;o++)n[o]^=r.mul(e[o],t);let o=0;for(;o<n.length&&0===n[o];)o++;n=n.slice(o)}return n},e.generateECPolynomial=function(t){let n=new Uint8Array([1]);for(let o=0;o<t;o++)n=e.mul(n,new Uint8Array([1,r.exp(o)]));return n}},726:(t,e)=>{function n(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");let e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map(function(t){return[t,t]}))),6===e.length&&e.push("F","F");const n=parseInt(e.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,o=t.scale||4;return{width:r,scale:r?4:o,margin:e,color:{dark:n(t.color.dark||"#000000ff"),light:n(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,n){const r=e.getScale(t,n);return Math.floor((t+2*n.margin)*r)},e.qrToImageData=function(t,n,r){const o=n.modules.size,i=n.modules.data,s=e.getScale(o,r),a=Math.floor((o+2*r.margin)*s),c=r.margin*s,u=[r.color.light,r.color.dark];for(let e=0;e<a;e++)for(let n=0;n<a;n++){let l=4*(e*a+n),f=r.color.light;e>=c&&n>=c&&e<a-c&&n<a-c&&(f=u[i[Math.floor((e-c)/s)*o+Math.floor((n-c)/s)]?1:0]),t[l++]=f.r,t[l++]=f.g,t[l++]=f.b,t[l]=f.a}}},731:(t,e)=>{const n=new Uint8Array(512),r=new Uint8Array(256);!function(){let t=1;for(let e=0;e<255;e++)n[e]=t,r[t]=e,t<<=1,256&t&&(t^=285);for(let t=255;t<512;t++)n[t]=n[t-255]}(),e.log=function(t){if(t<1)throw new Error("log("+t+")");return r[t]},e.exp=function(t){return n[t]},e.mul=function(t,e){return 0===t||0===e?0:n[r[t]+r[e]]}},756:(t,e,n)=>{const r=n(886).getSymbolSize;e.getPositions=function(t){const e=r(t);return[[0,0],[e-7,0],[0,e-7]]}},764:(t,e,n)=>{const r=n(713);function o(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}o.prototype.initialize=function(t){this.degree=t,this.genPoly=r.generateECPolynomial(this.degree)},o.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=r.mod(e,this.genPoly),o=this.degree-n.length;if(o>0){const t=new Uint8Array(this.degree);return t.set(n,o),t}return n},t.exports=o},801:(t,e,n)=>{const r=n(208),o=n(357),i=n(433),s=n(822),a=n(861),c=n(44),u=n(886),l=n(320);function f(t){return unescape(encodeURIComponent(t)).length}function h(t,e,n){const r=[];let o;for(;null!==(o=t.exec(n));)r.push({data:o[0],index:o.index,mode:e,length:o[0].length});return r}function d(t){const e=h(c.NUMERIC,r.NUMERIC,t),n=h(c.ALPHANUMERIC,r.ALPHANUMERIC,t);let o,i;return u.isKanjiModeEnabled()?(o=h(c.BYTE,r.BYTE,t),i=h(c.KANJI,r.KANJI,t)):(o=h(c.BYTE_KANJI,r.BYTE,t),i=[]),e.concat(n,o,i).sort(function(t,e){return t.index-e.index}).map(function(t){return{data:t.data,mode:t.mode,length:t.length}})}function g(t,e){switch(e){case r.NUMERIC:return o.getBitsLength(t);case r.ALPHANUMERIC:return i.getBitsLength(t);case r.KANJI:return a.getBitsLength(t);case r.BYTE:return s.getBitsLength(t)}}function p(t,e){let n;const c=r.getBestModeForData(t);if(n=r.from(e,c),n!==r.BYTE&&n.bit<c.bit)throw new Error('"'+t+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(c));switch(n!==r.KANJI||u.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new o(t);case r.ALPHANUMERIC:return new i(t);case r.KANJI:return new a(t);case r.BYTE:return new s(t)}}e.fromArray=function(t){return t.reduce(function(t,e){return"string"==typeof e?t.push(p(e,null)):e.data&&t.push(p(e.data,e.mode)),t},[])},e.fromString=function(t,n){const o=function(t){const e=[];for(let n=0;n<t.length;n++){const o=t[n];switch(o.mode){case r.NUMERIC:e.push([o,{data:o.data,mode:r.ALPHANUMERIC,length:o.length},{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.ALPHANUMERIC:e.push([o,{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.KANJI:e.push([o,{data:o.data,mode:r.BYTE,length:f(o.data)}]);break;case r.BYTE:e.push([{data:o.data,mode:r.BYTE,length:f(o.data)}])}}return e}(d(t,u.isKanjiModeEnabled())),i=function(t,e){const n={},o={start:{}};let i=["start"];for(let s=0;s<t.length;s++){const a=t[s],c=[];for(let t=0;t<a.length;t++){const u=a[t],l=""+s+t;c.push(l),n[l]={node:u,lastCount:0},o[l]={};for(let t=0;t<i.length;t++){const s=i[t];n[s]&&n[s].node.mode===u.mode?(o[s][l]=g(n[s].lastCount+u.length,u.mode)-g(n[s].lastCount,u.mode),n[s].lastCount+=u.length):(n[s]&&(n[s].lastCount=u.length),o[s][l]=g(u.length,u.mode)+4+r.getCharCountIndicator(u.mode,e))}}i=c}for(let t=0;t<i.length;t++)o[i[t]].end=0;return{map:o,table:n}}(o,n),s=l.find_path(i.map,"start","end"),a=[];for(let t=1;t<s.length-1;t++)a.push(i.table[s[t]].node);return e.fromArray(a.reduce(function(t,e){const n=t.length-1>=0?t[t.length-1]:null;return n&&n.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)},[]))},e.rawSplit=function(t){return e.fromArray(d(t,u.isKanjiModeEnabled()))}},820:t=>{function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}e.prototype.set=function(t,e,n,r){const o=t*this.size+e;this.data[o]=n,r&&(this.reservedBit[o]=!0)},e.prototype.get=function(t,e){return this.data[t*this.size+e]},e.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},e.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},t.exports=e},822:(t,e,n)=>{const r=n(208);function o(t){this.mode=r.BYTE,this.data="string"==typeof t?(new TextEncoder).encode(t):new Uint8Array(t)}o.getBitsLength=function(t){return 8*t},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)},t.exports=o},861:(t,e,n)=>{const r=n(208),o=n(886);function i(t){this.mode=r.KANJI,this.data=t}i.getBitsLength=function(t){return 13*t},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=o.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13)}},t.exports=i},878:(t,e)=>{e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}},886:(t,e)=>{let n;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];e.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},e.getSymbolTotalCodewords=function(t){return r[t]},e.getBCHDigit=function(t){let e=0;for(;0!==t;)e++,t>>>=1;return e},e.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');n=t},e.isKanjiModeEnabled=function(){return void 0!==n},e.toSJIS=function(t){return n(t)}},899:t=>{function e(){this.buffer=[],this.length=0}e.prototype={get:function(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=e},938:(t,e,n)=>{"use strict";n.d(e,{u2:()=>f.u2,lo:()=>r.lo,_I:()=>u,Bq:()=>r.Bq});var r=n(986),o=n(976),i=n(324);const s=new TextDecoder("utf-8"),a=(new TextEncoder,5e3);var c;function u(t){let{prefix:e,words:n}=i.I.decode(t,a),r=new Uint8Array(i.I.fromWords(n));switch(e){case"noffer":{const t=l(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for noffer");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(!t[1]?.[0])throw new Error("missing TLV 1 for noffer");if(!t[2]?.[0])throw new Error("missing TLV 2 for noffer");if(!t[3]?.[0])throw new Error("missing TLV 3 for noffer");return{type:"noffer",data:{pubkey:(0,o.My)(t[0][0]),relay:s.decode(t[1][0]),offer:s.decode(t[2][0]),priceType:t[3][0][0],price:t[4]?parseInt((0,o.My)(t[4][0]),16):void 0}}}case"ndebit":{const t=l(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for ndebit");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(!t[1]?.[0])throw new Error("missing TLV 1 for ndebit");return{type:"ndebit",data:{pubkey:(0,o.My)(t[0][0]),relay:s.decode(t[1][0]),pointer:t[2]?s.decode(t[2][0]):void 0}}}case"nmanage":{const t=l(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nmanage");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(!t[1]?.[0])throw new Error("missing TLV 1 for nmanage");return{type:"nmanage",data:{pubkey:(0,o.My)(t[0][0]),relay:s.decode(t[1][0]),pointer:t[2]?s.decode(t[2][0]):void 0}}}default:throw new Error(`unknown prefix ${e}`)}}function l(t){let e={},n=t;for(;n.length>0;){let t=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${t}`);e[t]=e[t]||[],e[t].push(o)}return e}!function(t){t[t.Fixed=0]="Fixed",t[t.Variable=1]="Variable",t[t.Spontaneous=2]="Spontaneous"}(c||(c={}));var f=n(235)},953:(t,e)=>{e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return n}}},976:(t,e,n)=>{"use strict";n.d(e,{My:()=>i});const r=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function i(t){if(function(t,...e){if(!((n=t)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}(t),r)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=o[t[n]];return e}},986:(t,e,n)=>{"use strict";n.d(e,{lo:()=>ai,pC:()=>gr,Bq:()=>hr,lG:()=>dr,Q5:()=>Hi});var r={};function o(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function i(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}n.r(r),n.d(r,{OG:()=>O,My:()=>k,Ph:()=>T,lX:()=>C,Id:()=>$,fg:()=>H,qj:()=>P,aT:()=>L,lq:()=>R,z:()=>N,Q5:()=>z});const a="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,c=t=>t instanceof Uint8Array,u=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),l=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function f(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!c(t))throw new Error("expected Uint8Array, got "+typeof t);return t}class h{clone(){return this._cloneInto()}}function d(t){const e=e=>t().update(f(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function g(t=32){if(a&&"function"==typeof a.getRandomValues)return a.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class p extends h{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=u(this.buffer)}update(t){s(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=f(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s===r){const e=u(t);for(;r<=o-i;i+=r)this.process(e,i);continue}n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){s(this),function(t,e){i(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>r-a&&(this.process(n,0),a=0);for(let t=a;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const c=u(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=l/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,h[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}const y=(t,e,n)=>t&e^~t&n,w=(t,e,n)=>t&e^t&n^e&n,m=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),b=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),E=new Uint32Array(64);class v extends p{constructor(){super(64,32,8,!1),this.A=0|b[0],this.B=0|b[1],this.C=0|b[2],this.D=0|b[3],this.E=0|b[4],this.F=0|b[5],this.G=0|b[6],this.H=0|b[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)E[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=E[t-15],n=E[t-2],r=l(e,7)^l(e,18)^e>>>3,o=l(n,17)^l(n,19)^n>>>10;E[t]=o+E[t-7]+r+E[t-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(l(s,6)^l(s,11)^l(s,25))+y(s,a,c)+m[t]+E[t]|0,f=(l(n,2)^l(n,13)^l(n,22))+w(n,r,o)|0;u=c,c=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+f|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){E.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const x=d(()=>new v),A=(BigInt(0),BigInt(1)),I=BigInt(2),B=t=>t instanceof Uint8Array,S=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function k(t){if(!B(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=S[t[n]];return e}function U(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function L(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n}function T(t){return U(k(t))}function C(t){if(!B(t))throw new Error("Uint8Array expected");return U(k(Uint8Array.from(t).reverse()))}function R(t,e){return L(t.toString(16).padStart(2*e,"0"))}function N(t,e){return R(t,e).reverse()}function P(t,e,n){let r;if("string"==typeof e)try{r=L(e)}catch(n){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${n}`)}else{if(!B(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function $(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!B(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}const O=t=>(I<<BigInt(t-1))-A,M=t=>new Uint8Array(t),_=t=>Uint8Array.from(t);function H(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=M(t),o=M(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...t)=>n(o,r,...t),c=(t=M())=>{o=a(_([0]),t),r=a(),0!==t.length&&(o=a(_([1]),t),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return $(...n)};return(t,e)=>{let n;for(s(),c(t);!(n=e(u()));)c();return s(),n}}const q={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function z(t,e,n={}){const r=(e,n,r)=>{const o=q[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=t[e];if(!(r&&void 0===i||o(i,t)))throw new Error(`Invalid param ${String(e)}=${i} (${typeof i}), expected ${n}`)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}const D=BigInt(0),F=BigInt(1),K=BigInt(2),j=BigInt(3),V=BigInt(4),W=BigInt(5),J=BigInt(8);function Z(t,e){const n=t%e;return n>=D?n:e+n}function Y(t,e,n){if(n<=D||e<D)throw new Error("Expected power/modulo > 0");if(n===F)return D;let r=F;for(;e>D;)e&F&&(r=r*t%n),t=t*t%n,e>>=F;return r}function G(t,e,n){let r=t;for(;e-- >D;)r*=r,r%=n;return r}function Q(t,e){if(t===D||e<=D)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Z(t,e),r=e,o=D,i=F,s=F,a=D;for(;n!==D;){const t=r/n,e=r%n,c=o-s*t,u=i-a*t;r=n,n=e,o=s,i=a,s=c,a=u}if(r!==F)throw new Error("invert: does not exist");return Z(o,e)}BigInt(9),BigInt(16);const X=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tt(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function et(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function nt(t){const e=et(t);return e+Math.ceil(e/2)}class rt extends h{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");o(t.outputLen),o(t.blockLen)}(t);const n=f(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return s(this),this.iHash.update(t),this}digestInto(t){s(this),i(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ot=(t,e,n)=>new rt(t,e).update(n).digest();ot.create=(t,e)=>new rt(t,e);const it=BigInt(0),st=BigInt(1);function at(t){return z(t.Fp,X.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),z(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...tt(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:ct,aT:ut}=r,lt={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=lt;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ct(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=lt,n="string"==typeof t?ut(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:i}=lt._parseInt(n.subarray(2)),{d:s,l:a}=lt._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},ft=BigInt(0),ht=BigInt(1),dt=(BigInt(2),BigInt(3));function gt(t){const e=function(t){const e=at(t);return z(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(t){return Z(t,r)}function a(t){return Q(t,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:f}=function(t){const e=function(t){const e=at(t);z(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,r=e.toBytes||((t,e,r)=>{const o=e.toAffine();return $(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function i(t){const{a:r,b:o}=e,i=n.sqr(t),s=n.mul(i,t);return n.add(n.add(s,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&ft<t&&t<e.n}function a(t){if(!s(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=k(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*r,"0")}let s;try{s="bigint"==typeof t?t:T(P("private key",t,r))}catch(e){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return o&&(s=Z(s,i)),a(s),s}const u=new Map;function l(t){if(!(t instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof f)throw new Error("projective point not allowed");const o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?f.ZERO:new f(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(f.fromAffine)}static fromHex(t){const e=f.fromAffine(o(P("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return f.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(t);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){l(t);const{px:e,py:r,pz:o}=this,{px:i,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new f(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,o=n.mul(r,dt),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,h=n.mul(i,i),d=n.mul(s,s),g=n.mul(a,a),p=n.mul(i,s);return p=n.add(p,p),l=n.mul(i,a),l=n.add(l,l),c=n.mul(t,l),u=n.mul(o,g),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(p,c),l=n.mul(o,l),g=n.mul(t,g),p=n.sub(h,g),p=n.mul(t,p),p=n.add(p,l),l=n.add(h,h),h=n.add(l,h),h=n.add(h,g),h=n.mul(h,p),u=n.add(u,h),g=n.mul(s,a),g=n.add(g,g),h=n.mul(g,p),c=n.sub(c,h),l=n.mul(g,d),l=n.add(l,l),l=n.add(l,l),new f(c,u,l)}add(t){l(t);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=t;let u=n.ZERO,h=n.ZERO,d=n.ZERO;const g=e.a,p=n.mul(e.b,dt);let y=n.mul(r,s),w=n.mul(o,a),m=n.mul(i,c),b=n.add(r,o),E=n.add(s,a);b=n.mul(b,E),E=n.add(y,w),b=n.sub(b,E),E=n.add(r,i);let v=n.add(s,c);return E=n.mul(E,v),v=n.add(y,m),E=n.sub(E,v),v=n.add(o,i),u=n.add(a,c),v=n.mul(v,u),u=n.add(w,m),v=n.sub(v,u),d=n.mul(g,E),u=n.mul(p,m),d=n.add(u,d),u=n.sub(w,d),d=n.add(w,d),h=n.mul(u,d),w=n.add(y,y),w=n.add(w,y),m=n.mul(g,m),E=n.mul(p,E),w=n.add(w,m),m=n.sub(y,m),m=n.mul(g,m),E=n.add(E,m),y=n.mul(w,E),h=n.add(h,y),y=n.mul(v,E),u=n.mul(b,u),u=n.sub(u,y),y=n.mul(b,w),d=n.mul(v,d),d=n.add(d,y),new f(u,h,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(f.ZERO)}wNAF(t){return d.wNAFCached(this,u,t,t=>{const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(f.fromAffine)})}multiplyUnsafe(t){const r=f.ZERO;if(t===ft)return r;if(a(t),t===ht)return this;const{endo:o}=e;if(!o)return d.unsafeLadder(this,t);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(t),l=r,h=r,g=this;for(;s>ft||u>ft;)s&ht&&(l=l.add(g)),u&ht&&(h=h.add(g)),g=g.double(),s>>=ht,u>>=ht;return i&&(l=l.negate()),c&&(h=h.negate()),h=new f(n.mul(h.px,o.beta),h.py,h.pz),l.add(h)}multiply(t){a(t);let r,o,i=t;const{endo:s}=e;if(s){const{k1neg:t,k1:e,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(e),{p:h,f:g}=this.wNAF(c);u=d.constTimeNegate(t,u),h=d.constTimeNegate(a,h),h=new f(n.mul(h.px,s.beta),h.py,h.pz),r=u.add(h),o=l.add(g)}else{const{p:t,f:e}=this.wNAF(i);r=t,o=e}return f.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(t,e,n){const r=f.BASE,o=(t,e)=>e!==ft&&e!==ht&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),i=o(this,e).add(o(t,n));return i.is0()?void 0:i}toAffine(t){const{px:e,py:r,pz:o}=this,i=this.is0();null==t&&(t=i?n.ONE:n.inv(o));const s=n.mul(e,t),a=n.mul(r,t),c=n.mul(o,t);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===ht)return!0;if(n)return n(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===ht?this:n?n(f,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),r(f,this,t)}toHex(t=!0){return k(this.toRawBytes(t))}}f.BASE=new f(e.Gx,e.Gy,n.ONE),f.ZERO=new f(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,d=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,o=e;for(;n>it;)n&st&&(r=r.add(o)),o=o.double(),n>>=st;return r},precomputeWindow(t,e){const{windows:n,windowSize:o}=r(e),i=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,i.push(a);for(let t=1;t<o;t++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(e,o,i){const{windows:s,windowSize:a}=r(e);let c=t.ZERO,u=t.BASE;const l=BigInt(2**e-1),f=2**e,h=BigInt(e);for(let t=0;t<s;t++){const e=t*a;let r=Number(i&l);i>>=h,r>a&&(r-=f,i+=st);const s=e,d=e+Math.abs(r)-1,g=t%2!=0,p=r<0;0===r?u=u.add(n(g,o[s])):c=c.add(n(p,o[d]))}return{p:c,f:u}},wNAFCached(t,e,n,r){const o=t._WINDOW_SIZE||1;let i=e.get(t);return i||(i=this.precomputeWindow(t,o),1!==o&&e.set(t,r(i))),this.wNAF(o,i,n)}}}(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}({...e,toBytes(t,e,r){const o=e.toAffine(),i=n.toBytes(o.x),s=$;return r?s(Uint8Array.from([e.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(t){const e=t.length,r=t[0],s=t.subarray(1);if(e!==o||2!==r&&3!==r){if(e===i&&4===r)return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const t=T(s);if(!(ft<(a=t)&&a<n.ORDER))throw new Error("Point is not on curve");const e=l(t);let o=n.sqrt(e);return!(1&~r)!=((o&ht)===ht)&&(o=n.neg(o)),{x:t,y:o}}var a}}),h=t=>k(R(t,e.nByteLength));function d(t){return t>r>>ht}const g=(t,e,n)=>T(t.slice(e,n));class p{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const n=e.nByteLength;return t=P("compactSignature",t,2*n),new p(g(t,0,n),g(t,n,2*n))}static fromDER(t){const{r:e,s:n}=lt.toSig(P("DER",t));return new p(e,n)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){const{r,s:o,recovery:i}=this,u=b(P("msgHash",t));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+e.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=1&i?"03":"02",d=c.fromHex(f+h(l)),g=a(l),p=s(-u*g),y=s(o*g),w=c.BASE.multiplyAndAddUnsafe(d,p,y);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return L(this.toDERHex())}toDERHex(){return lt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return L(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const y={isValidPrivateKey(t){try{return u(t),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const t=nt(e.n);return function(t,e,n=!1){const r=t.length,o=et(e),i=nt(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=Z(n?T(t):C(t),e-F)+F;return n?N(s,o):R(s,o)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function w(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===o||r===i:n?r===2*o||r===2*i:t instanceof c}const m=e.bits2int||function(t){const n=T(t),r=8*t.length-e.nBitLength;return r>0?n>>BigInt(r):n},b=e.bits2int_modN||function(t){return s(m(t))},E=O(e.nBitLength);function v(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(ft<=t&&t<E))throw new Error(`bigint expected < 2^${e.nBitLength}`);return R(t,e.nByteLength)}const x={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(w(t))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(u(t)).toRawBytes(n)},sign:function(t,r,o=x){const{seed:i,k2sig:l}=function(t,r,o=x){if(["recovered","canonical"].some(t=>t in o))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=e;let{lowS:h,prehash:g,extraEntropy:y}=o;null==h&&(h=!0),t=P("msgHash",t),g&&(t=P("prehashed msgHash",i(t)));const w=b(t),E=u(r),A=[v(E),v(w)];if(null!=y){const t=!0===y?l(n.BYTES):y;A.push(P("extraEntropy",t))}const I=$(...A),B=w;return{seed:I,k2sig:function(t){const e=m(t);if(!f(e))return;const n=a(e),r=c.BASE.multiply(e).toAffine(),o=s(r.x);if(o===ft)return;const i=s(n*s(B+o*E));if(i===ft)return;let u=(r.x===o?0:2)|Number(r.y&ht),l=i;return h&&d(i)&&(l=function(t){return d(t)?s(-t):t}(i),u^=1),new p(o,l,u)}}}(t,r,o),h=e;return H(h.hash.outputLen,h.nByteLength,h.hmac)(i,l)},verify:function(t,n,r,o=A){const i=t;if(n=P("msgHash",n),r=P("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let f,h;try{if("string"==typeof i||i instanceof Uint8Array)try{f=p.fromDER(i)}catch(t){if(!(t instanceof lt.Err))throw t;f=p.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:t,s:e}=i;f=new p(t,e)}}h=c.fromHex(r)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&f.hasHighS())return!1;l&&(n=e.hash(n));const{r:d,s:g}=f,y=b(n),w=a(g),m=s(y*w),E=s(d*w),v=c.BASE.multiplyAndAddUnsafe(h,m,E)?.toAffine();return!!v&&s(v.x)===d},ProjectivePoint:c,Signature:p,utils:y}}function pt(t){return{hash:t,hmac:(e,...n)=>ot(t,e,function(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!c(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}(...n)),randomBytes:g}}BigInt(4);const yt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),wt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),mt=BigInt(1),bt=BigInt(2),Et=(t,e)=>(t+e/bt)/e;function vt(t){const e=yt,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,f=G(l,n,e)*l%e,h=G(f,n,e)*l%e,d=G(h,bt,e)*u%e,g=G(d,o,e)*d%e,p=G(g,i,e)*g%e,y=G(p,a,e)*p%e,w=G(y,c,e)*y%e,m=G(w,a,e)*p%e,b=G(m,n,e)*l%e,E=G(b,s,e)*g%e,v=G(E,r,e)*u%e,x=G(v,bt,e);if(!xt.eql(xt.sqr(x),t))throw new Error("Cannot find square root");return x}const xt=function(t,e,n=!1,r={}){if(t<=D)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=tt(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=function(t){if(t%V===j){const e=(t+F)/V;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%J===W){const e=(t-W)/J;return function(t,n){const r=t.mul(n,K),o=t.pow(r,e),i=t.mul(n,o),s=t.mul(t.mul(i,K),o),a=t.mul(i,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-F)/K;let n,r,o;for(n=t-F,r=0;n%K===D;n/=K,r++);for(o=K;o<t&&Y(o,e,t)!==t-F;o++);if(1===r){const e=(t+F)/V;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+F)/K;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=r,c=t.pow(t.mul(t.ONE,o),n),u=t.pow(s,i),l=t.pow(s,n);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=1;for(let n=t.sqr(l);e<a&&!t.eql(n,t.ONE);e++)n=t.sqr(n);const n=t.pow(c,F<<BigInt(a-e-1));c=t.sqr(n),u=t.mul(u,n),l=t.mul(l,c),a=e}return u}}(t)}(t),a=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:O(o),ZERO:D,ONE:F,create:e=>Z(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return D<=e&&e<t},is0:t=>t===D,isOdd:t=>(t&F)===F,neg:e=>Z(-e,t),eql:(t,e)=>t===e,sqr:e=>Z(e*e,t),add:(e,n)=>Z(e+n,t),sub:(e,n)=>Z(e-n,t),mul:(e,n)=>Z(e*n,t),pow:(t,e)=>function(t,e,n){if(n<D)throw new Error("Expected power > 0");if(n===D)return t.ONE;if(n===F)return e;let r=t.ONE,o=e;for(;n>D;)n&F&&(r=t.mul(r,o)),o=t.sqr(o),n>>=F;return r}(a,t,e),div:(e,n)=>Z(e*Q(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Q(e,t),sqrt:r.sqrt||(t=>s(a,t)),invertBatch:t=>function(t,e){const n=new Array(e.length),r=e.reduce((e,r,o)=>t.is0(r)?e:(n[o]=e,t.mul(e,r)),t.ONE),o=t.inv(r);return e.reduceRight((e,r,o)=>t.is0(r)?e:(n[o]=t.mul(e,n[o]),t.mul(e,r)),o),n}(a,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?N(t,i):R(t,i),fromBytes:t=>{if(t.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${t.length}`);return n?C(t):T(t)}});return Object.freeze(a)}(yt,void 0,void 0,{sqrt:vt}),At=function(t,e){const n=e=>gt({...t,...pt(e)});return Object.freeze({...n(e),create:n})}({a:BigInt(0),b:BigInt(7),Fp:xt,n:wt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=wt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-mt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Et(i*t,e),c=Et(-r*t,e);let u=Z(t-a*n-c*o,e),l=Z(-a*r-c*i,e);const f=u>s,h=l>s;if(f&&(u=e-u),h&&(l=e-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:l}}}},x),It=BigInt(0),Bt=t=>"bigint"==typeof t&&It<t&&t<yt,St={};function kt(t,...e){let n=St[t];if(void 0===n){const e=x(Uint8Array.from(t,t=>t.charCodeAt(0)));n=$(e,e),St[t]=n}return x($(n,...e))}const Ut=t=>t.toRawBytes(!0).slice(1),Lt=t=>R(t,32),Tt=t=>Z(t,yt),Ct=t=>Z(t,wt),Rt=At.ProjectivePoint;function Nt(t){let e=At.utils.normPrivateKeyToScalar(t),n=Rt.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:Ct(-e),bytes:Ut(n)}}function Pt(t){if(!Bt(t))throw new Error("bad x: need 0 < x < p");const e=Tt(t*t);let n=vt(Tt(e*t+BigInt(7)));n%bt!==It&&(n=Tt(-n));const r=new Rt(t,n,mt);return r.assertValidity(),r}function $t(...t){return Ct(T(kt("BIP0340/challenge",...t)))}function Ot(t){return Nt(t).bytes}function Mt(t,e,n=g(32)){const r=P("message",t),{bytes:o,scalar:i}=Nt(e),s=P("auxRand",n,32),a=Lt(i^T(kt("BIP0340/aux",s))),c=kt("BIP0340/nonce",a,o,r),u=Ct(T(c));if(u===It)throw new Error("sign failed: k is zero");const{bytes:l,scalar:f}=Nt(u),h=$t(l,o,r),d=new Uint8Array(64);if(d.set(l,0),d.set(Lt(Ct(f+h*i)),32),!_t(d,r,o))throw new Error("sign: Invalid signature produced");return d}function _t(t,e,n){const r=P("signature",t,64),o=P("message",e),i=P("publicKey",n,32);try{const t=Pt(T(i)),e=T(r.subarray(0,32));if(!Bt(e))return!1;const n=T(r.subarray(32,64));if(!("bigint"==typeof(u=n)&&It<u&&u<wt))return!1;const l=$t(Lt(e),Ut(t),o),f=(s=t,a=n,c=Ct(-l),Rt.BASE.multiplyAndAddUnsafe(s,a,c));return!(!f||!f.hasEvenY()||f.toAffine().x!==e)}catch(t){return!1}var s,a,c,u}const Ht=(()=>({getPublicKey:Ot,sign:Mt,verify:_t,utils:{randomPrivateKey:At.utils.randomPrivateKey,lift_x:Pt,pointToBytes:Ut,numberToBytesBE:R,bytesToNumberBE:T,taggedHash:kt,mod:Z}}))(),qt="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,zt=t=>t instanceof Uint8Array,Dt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ft=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const Kt=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function jt(t){if(!zt(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Kt[t[n]];return e}function Vt(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n}function Wt(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!zt(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Jt(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!zt(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}class Zt{clone(){return this._cloneInto()}}function Yt(t){const e=e=>t().update(Wt(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Gt(t=32){if(qt&&"function"==typeof qt.getRandomValues)return qt.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Qt(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Xt(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}const te={number:Qt,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Xt,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Qt(t.outputLen),Qt(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){Xt(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}};class ee extends Zt{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Dt(this.buffer)}update(t){te.exists(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=Wt(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s===r){const e=Dt(t);for(;r<=o-i;i+=r)this.process(e,i);continue}n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){te.exists(this),te.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let t=i;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=Dt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}const ne=(t,e,n)=>t&e^~t&n,re=(t,e,n)=>t&e^t&n^e&n,oe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ie=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),se=new Uint32Array(64);class ae extends ee{constructor(){super(64,32,8,!1),this.A=0|ie[0],this.B=0|ie[1],this.C=0|ie[2],this.D=0|ie[3],this.E=0|ie[4],this.F=0|ie[5],this.G=0|ie[6],this.H=0|ie[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)se[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=se[t-15],n=se[t-2],r=Ft(e,7)^Ft(e,18)^e>>>3,o=Ft(n,17)^Ft(n,19)^n>>>10;se[t]=o+se[t-7]+r+se[t-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Ft(s,6)^Ft(s,11)^Ft(s,25))+ne(s,a,c)+oe[t]+se[t]|0,l=(Ft(n,2)^Ft(n,13)^Ft(n,22))+re(n,r,o)|0;u=c,c=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){se.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class ce extends ae{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const ue=Yt(()=>new ae);function le(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function fe(...t){const e=(t,e)=>n=>t(e(n)),n=Array.from(t).reverse().reduce((t,n)=>t?e(t,n.encode):n.encode,void 0),r=t.reduce((t,n)=>t?e(t,n.decode):n.decode,void 0);return{encode:n,decode:r}}function he(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map(e=>{if(le(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]})},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map(e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const n=t.indexOf(e);if(-1===n)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return n})}}}function de(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw new Error(`join.encode: non-string input=${t}`);return e.join(t)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(t)}}}function ge(t,e="="){if(le(t),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.encode: non-string input=${t}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.decode: non-string input=${t}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function pe(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:t=>t,decode:e=>t(e)}}function ye(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach(t=>{if(le(t),t<0||t>=e)throw new Error(`Wrong integer: ${t}`)});;){let t=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=e*t+a;if(!Number.isSafeInteger(c)||e*t/e!==t||c-a!==e*t)throw new Error("convertRadix: carry overflow");if(t=c%n,i[o]=Math.floor(c/n),!Number.isSafeInteger(i[o])||i[o]*n+t!==c)throw new Error("convertRadix: carry overflow");s&&(i[o]?s=!1:r=o)}if(o.push(t),s)break}for(let e=0;e<t.length-1&&0===t[e];e++)o.push(0);return o.reverse()}Yt(()=>new ce);const we=(t,e)=>e?we(e,t%e):t,me=(t,e)=>t+(e-we(t,e));function be(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(me(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${me(e,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of t){if(le(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(o=o<<e|r,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function Ee(t,e=!1){if(le(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(me(8,t)>32||me(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return be(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(be(n,t,8,e))}}}function ve(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch(t){}}}fe(Ee(4),he("0123456789ABCDEF"),de("")),fe(Ee(5),he("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),ge(5),de(""));const xe=(fe(Ee(5),he("0123456789ABCDEFGHIJKLMNOPQRSTUV"),ge(5),de("")),fe(Ee(5),he("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),de(""),pe(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),fe(Ee(6),he("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ge(6),de(""))),Ae=(fe(Ee(6),he("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),ge(6),de("")),t=>{return fe((le(e=58),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return ye(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(ye(t,e,256))}}),he(t),de(""));var e}),Ie=(Ae("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Ae("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Ae("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),fe(he("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),de(""))),Be=[996825010,642813549,513874426,1027748829,705979059];function Se(t){const e=t>>25;let n=(33554431&t)<<5;for(let t=0;t<Be.length;t++)1==(e>>t&1)&&(n^=Be[t]);return n}function ke(t,e,n=1){const r=t.length;let o=1;for(let e=0;e<r;e++){const n=t.charCodeAt(e);if(n<33||n>126)throw new Error(`Invalid prefix (${t})`);o=Se(o)^n>>5}o=Se(o);for(let e=0;e<r;e++)o=Se(o)^31&t.charCodeAt(e);for(let t of e)o=Se(o)^t;for(let t=0;t<6;t++)o=Se(o);return o^=n,Ie.encode(be([o%2**30],30,5,!1))}function Ue(t){const e="bech32"===t?1:734539939,n=Ee(5),r=n.decode,o=n.encode,i=ve(r);function s(t,n=90){if("string"!=typeof t)throw new Error("bech32.decode input should be string, not "+typeof t);if(t.length<8||!1!==n&&t.length>n)throw new TypeError(`Wrong string length: ${t.length} (${t}). Expected (8..${n})`);const r=t.toLowerCase();if(t!==r&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(t=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=t.slice(0,o),s=t.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=Ie.decode(s).slice(0,-6),c=ke(i,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${t}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(t,n,r=90){if("string"!=typeof t)throw new Error("bech32.encode prefix should be string, not "+typeof t);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=t.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${t=t.toLowerCase()}1${Ie.encode(n)}${ke(t,n,e)}`},decode:s,decodeToBytes:function(t){const{prefix:e,words:n}=s(t,!1);return{prefix:e,words:n,bytes:r(n)}},decodeUnsafe:ve(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const Le=Ue("bech32");Ue("bech32m");function Te(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Ce(t){if("boolean"!=typeof t)throw new Error(`boolean expected, not ${t}`)}function Re(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function Ne(t,...e){if(!Re(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Pe(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $e(t,e){Ne(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}fe(Ee(4),he("0123456789abcdef"),de(""),pe(t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}));const Oe=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),Me=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),_e=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function He(t){if("string"==typeof t)t=function(t){if("string"!=typeof t)throw new Error("string expected, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t);else{if(!Re(t))throw new Error("Uint8Array expected, got "+typeof t);t=t.slice()}return t}function qe(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n}const ze=(t,e)=>(Object.assign(e,t),e);function De(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}const Fe=16,Ke=new Uint8Array(16),je=Me(Ke),Ve=(t,e,n,r)=>({s3:n<<31|r>>>1,s2:e<<31|n>>>1,s1:t<<31|e>>>1,s0:t>>>1^225<<24&-(1&r)}),We=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255;class Je{constructor(t,e){this.blockLen=Fe,this.outputLen=Fe,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,Ne(t=He(t),16);const n=_e(t);let r=n.getUint32(0,!1),o=n.getUint32(4,!1),i=n.getUint32(8,!1),s=n.getUint32(12,!1);const a=[];for(let t=0;t<128;t++)a.push({s0:We(r),s1:We(o),s2:We(i),s3:We(s)}),({s0:r,s1:o,s2:i,s3:s}=Ve(r,o,i,s));const c=(t=>t>65536?8:t>1024?4:2)(e||1024);if(![1,2,4,8].includes(c))throw new Error(`ghash: wrong window size=${c}, should be 2, 4 or 8`);this.W=c;const u=128/c,l=this.windowSize=2**c,f=[];for(let t=0;t<u;t++)for(let e=0;e<l;e++){let n=0,r=0,o=0,i=0;for(let s=0;s<c;s++){if(!(e>>>c-s-1&1))continue;const{s0:u,s1:l,s2:f,s3:h}=a[c*t+s];n^=u,r^=l,o^=f,i^=h}f.push({s0:n,s1:r,s2:o,s3:i})}this.t=f}_updateBlock(t,e,n,r){t^=this.s0,e^=this.s1,n^=this.s2,r^=this.s3;const{W:o,t:i,windowSize:s}=this;let a=0,c=0,u=0,l=0;const f=(1<<o)-1;let h=0;for(const d of[t,e,n,r])for(let t=0;t<4;t++){const e=d>>>8*t&255;for(let t=8/o-1;t>=0;t--){const n=e>>>o*t&f,{s0:r,s1:d,s2:g,s3:p}=i[h*s+n];a^=r,c^=d,u^=g,l^=p,h+=1}}this.s0=a,this.s1=c,this.s2=u,this.s3=l}update(t){t=He(t),Pe(this);const e=Me(t),n=Math.floor(t.length/Fe),r=t.length%Fe;for(let t=0;t<n;t++)this._updateBlock(e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]);return r&&(Ke.set(t.subarray(n*Fe)),this._updateBlock(je[0],je[1],je[2],je[3]),je.fill(0)),this}destroy(){const{t}=this;for(const e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){Pe(this),$e(t,this),this.finished=!0;const{s0:e,s1:n,s2:r,s3:o}=this,i=Me(t);return i[0]=e,i[1]=n,i[2]=r,i[3]=o,t}digest(){const t=new Uint8Array(Fe);return this.digestInto(t),this.destroy(),t}}class Ze extends Je{constructor(t,e){const n=function(t){t.reverse();const e=1&t[15];let n=0;for(let e=0;e<t.length;e++){const r=t[e];t[e]=r>>>1|n,n=(1&r)<<7}return t[0]^=225&-e,t}((t=He(t)).slice());super(n,e),n.fill(0)}update(t){t=He(t),Pe(this);const e=Me(t),n=t.length%Fe,r=Math.floor(t.length/Fe);for(let t=0;t<r;t++)this._updateBlock(We(e[4*t+3]),We(e[4*t+2]),We(e[4*t+1]),We(e[4*t+0]));return n&&(Ke.set(t.subarray(r*Fe)),this._updateBlock(We(je[3]),We(je[2]),We(je[1]),We(je[0])),je.fill(0)),this}digestInto(t){Pe(this),$e(t,this),this.finished=!0;const{s0:e,s1:n,s2:r,s3:o}=this,i=Me(t);return i[0]=e,i[1]=n,i[2]=r,i[3]=o,t.reverse()}}function Ye(t){const e=(e,n)=>t(n,e.length).update(He(e)).digest(),n=t(new Uint8Array(16),0);return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(e,n)=>t(e,n),e}const Ge=Ye((t,e)=>new Je(t,e)),Qe=Ye((t,e)=>new Ze(t,e)),Xe=16,tn=new Uint8Array(Xe);function en(t){return t<<1^283&-(t>>7)}function nn(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(1&e),t=en(t);return n}const rn=(()=>{let t=new Uint8Array(256);for(let e=0,n=1;e<256;e++,n^=en(n))t[e]=n;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return e})(),on=rn.map((t,e)=>rn.indexOf(e)),sn=t=>t<<24|t>>>8,an=t=>t<<8|t>>>24;function cn(t,e){if(256!==t.length)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((n,r)=>e(t[r])),r=n.map(an),o=r.map(an),i=o.map(an),s=new Uint32Array(65536),a=new Uint32Array(65536),c=new Uint16Array(65536);for(let e=0;e<256;e++)for(let u=0;u<256;u++){const l=256*e+u;s[l]=n[e]^r[u],a[l]=o[e]^i[u],c[l]=t[e]<<8|t[u]}return{sbox:t,sbox2:c,T0:n,T1:r,T2:o,T3:i,T01:s,T23:a}}const un=cn(rn,t=>nn(t,3)<<24|t<<16|t<<8|nn(t,2)),ln=cn(on,t=>nn(t,11)<<24|nn(t,13)<<16|nn(t,9)<<8|nn(t,14)),fn=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=en(n))t[e]=n;return t})();function hn(t){Ne(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=un,r=Me(t),o=r.length,i=t=>pn(n,t,t,t,t),s=new Uint32Array(e+28);s.set(r);for(let t=o;t<s.length;t++){let e=s[t-1];t%o===0?e=i(sn(e))^fn[t/o-1]:o>6&&t%o===4&&(e=i(e)),s[t]=s[t-o]^e}return s}function dn(t){const e=hn(t),n=e.slice(),r=e.length,{sbox2:o}=un,{T0:i,T1:s,T2:a,T3:c}=ln;for(let t=0;t<r;t+=4)for(let o=0;o<4;o++)n[t+o]=e[r-t-4+o];e.fill(0);for(let t=4;t<r-4;t++){const e=n[t],r=pn(o,e,e,e,e);n[t]=i[255&r]^s[r>>>8&255]^a[r>>>16&255]^c[r>>>24]}return n}function gn(t,e,n,r,o,i){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|i>>>24&255]}function pn(t,e,n,r,o){return t[255&e|65280&n]|t[r>>>16&255|o>>>16&65280]<<16}function yn(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=un;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const u=t.length/4-2;for(let i=0;i<u;i++){const i=t[c++]^gn(s,a,e,n,r,o),u=t[c++]^gn(s,a,n,r,o,e),l=t[c++]^gn(s,a,r,o,e,n),f=t[c++]^gn(s,a,o,e,n,r);e=i,n=u,r=l,o=f}return{s0:t[c++]^pn(i,e,n,r,o),s1:t[c++]^pn(i,n,r,o,e),s2:t[c++]^pn(i,r,o,e,n),s3:t[c++]^pn(i,o,e,n,r)}}function wn(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=ln;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const u=t.length/4-2;for(let i=0;i<u;i++){const i=t[c++]^gn(s,a,e,o,r,n),u=t[c++]^gn(s,a,n,e,o,r),l=t[c++]^gn(s,a,r,n,e,o),f=t[c++]^gn(s,a,o,r,n,e);e=i,n=u,r=l,o=f}return{s0:t[c++]^pn(i,e,o,r,n),s1:t[c++]^pn(i,n,e,o,r),s2:t[c++]^pn(i,r,n,e,o),s3:t[c++]^pn(i,o,r,n,e)}}function mn(t,e){if(!e)return new Uint8Array(t);if(Ne(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function bn(t,e,n,r,o){Ne(n,Xe),Ne(r),o=mn(r.length,o);const i=n,s=Me(i),a=_e(i),c=Me(r),u=Me(o),l=e?0:12,f=r.length;let h=a.getUint32(l,e),{s0:d,s1:g,s2:p,s3:y}=yn(t,s[0],s[1],s[2],s[3]);for(let n=0;n+4<=c.length;n+=4)u[n+0]=c[n+0]^d,u[n+1]=c[n+1]^g,u[n+2]=c[n+2]^p,u[n+3]=c[n+3]^y,h=h+1>>>0,a.setUint32(l,h,e),({s0:d,s1:g,s2:p,s3:y}=yn(t,s[0],s[1],s[2],s[3]));const w=Xe*Math.floor(c.length/4);if(w<f){const t=new Uint32Array([d,g,p,y]),e=Oe(t);for(let t=w,n=0;t<f;t++,n++)o[t]=r[t]^e[n]}return o}function En(t){if(Ne(t),t.length%Xe!==0)throw new Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function vn(t,e,n){let r=t.length;const o=r%Xe;if(!e&&0!==o)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const i=Me(t);if(e){let t=Xe-o;t||(t=Xe),r+=t}const s=mn(r,n);return{b:i,o:Me(s),out:s}}function xn(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=t.subarray(0,-r);for(let e=0;e<r;e++)if(t[n-e-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function An(t){const e=new Uint8Array(16),n=Me(e);e.set(t);const r=Xe-t.length;for(let t=Xe-r;t<Xe;t++)e[t]=r;return n}ze({blockSize:16,nonceLength:16},function(t,e){function n(n,r){const o=hn(t),i=e.slice(),s=function(t,e,n,r){Ne(e,Xe),Ne(n);const o=n.length;r=mn(o,r);const i=e,s=Me(i);let{s0:a,s1:c,s2:u,s3:l}=yn(t,s[0],s[1],s[2],s[3]);const f=Me(n),h=Me(r);for(let e=0;e+4<=f.length;e+=4){h[e+0]=f[e+0]^a,h[e+1]=f[e+1]^c,h[e+2]=f[e+2]^u,h[e+3]=f[e+3]^l;let n=1;for(let t=i.length-1;t>=0;t--)n=n+(255&i[t])|0,i[t]=255&n,n>>>=8;({s0:a,s1:c,s2:u,s3:l}=yn(t,s[0],s[1],s[2],s[3]))}const d=Xe*Math.floor(f.length/4);if(d<o){const t=new Uint32Array([a,c,u,l]),e=Oe(t);for(let t=d,i=0;t<o;t++,i++)r[t]=n[t]^e[i]}return r}(o,i,n,r);return o.fill(0),i.fill(0),s}return Ne(t),Ne(e,Xe),{encrypt:(t,e)=>n(t,e),decrypt:(t,e)=>n(t,e)}}),ze({blockSize:16},function(t,e={}){Ne(t);const n=!e.disablePadding;return{encrypt:(e,r)=>{Ne(e);const{b:o,o:i,out:s}=vn(e,n,r),a=hn(t);let c=0;for(;c+4<=o.length;){const{s0:t,s1:e,s2:n,s3:r}=yn(a,o[c+0],o[c+1],o[c+2],o[c+3]);i[c++]=t,i[c++]=e,i[c++]=n,i[c++]=r}if(n){const t=An(e.subarray(4*c)),{s0:n,s1:r,s2:o,s3:s}=yn(a,t[0],t[1],t[2],t[3]);i[c++]=n,i[c++]=r,i[c++]=o,i[c++]=s}return a.fill(0),s},decrypt:(e,r)=>{En(e);const o=dn(t),i=mn(e.length,r),s=Me(e),a=Me(i);for(let t=0;t+4<=s.length;){const{s0:e,s1:n,s2:r,s3:i}=wn(o,s[t+0],s[t+1],s[t+2],s[t+3]);a[t++]=e,a[t++]=n,a[t++]=r,a[t++]=i}return o.fill(0),xn(i,n)}}});const In=ze({blockSize:16,nonceLength:16},function(t,e,n={}){Ne(t),Ne(e,16);const r=!n.disablePadding;return{encrypt:(n,o)=>{const i=hn(t),{b:s,o:a,out:c}=vn(n,r,o),u=Me(e);let l=u[0],f=u[1],h=u[2],d=u[3],g=0;for(;g+4<=s.length;)l^=s[g+0],f^=s[g+1],h^=s[g+2],d^=s[g+3],({s0:l,s1:f,s2:h,s3:d}=yn(i,l,f,h,d)),a[g++]=l,a[g++]=f,a[g++]=h,a[g++]=d;if(r){const t=An(n.subarray(4*g));l^=t[0],f^=t[1],h^=t[2],d^=t[3],({s0:l,s1:f,s2:h,s3:d}=yn(i,l,f,h,d)),a[g++]=l,a[g++]=f,a[g++]=h,a[g++]=d}return i.fill(0),c},decrypt:(n,o)=>{En(n);const i=dn(t),s=Me(e),a=mn(n.length,o),c=Me(n),u=Me(a);let l=s[0],f=s[1],h=s[2],d=s[3];for(let t=0;t+4<=c.length;){const e=l,n=f,r=h,o=d;l=c[t+0],f=c[t+1],h=c[t+2],d=c[t+3];const{s0:s,s1:a,s2:g,s3:p}=wn(i,l,f,h,d);u[t++]=s^e,u[t++]=a^n,u[t++]=g^r,u[t++]=p^o}return i.fill(0),xn(a,r)}}});function Bn(t,e,n,r,o){const i=t.create(n,r.length+(o?.length||0));o&&i.update(o),i.update(r);const s=new Uint8Array(16),a=_e(s);return o&&De(a,0,BigInt(8*o.length),e),De(a,8,BigInt(8*r.length),e),i.update(s),i.digest()}ze({blockSize:16,nonceLength:16},function(t,e){function n(n,r,o){const i=hn(t),s=n.length;o=mn(s,o);const a=Me(n),c=Me(o),u=r?c:a,l=Me(e);let f=l[0],h=l[1],d=l[2],g=l[3];for(let t=0;t+4<=a.length;){const{s0:e,s1:n,s2:r,s3:o}=yn(i,f,h,d,g);c[t+0]=a[t+0]^e,c[t+1]=a[t+1]^n,c[t+2]=a[t+2]^r,c[t+3]=a[t+3]^o,f=u[t++],h=u[t++],d=u[t++],g=u[t++]}const p=Xe*Math.floor(a.length/4);if(p<s){({s0:f,s1:h,s2:d,s3:g}=yn(i,f,h,d,g));const t=Oe(new Uint32Array([f,h,d,g]));for(let e=p,r=0;e<s;e++,r++)o[e]=n[e]^t[r];t.fill(0)}return i.fill(0),o}return Ne(t),Ne(e,16),{encrypt:(t,e)=>n(t,!0,e),decrypt:(t,e)=>n(t,!1,e)}}),ze({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){if(Ne(e),0===e.length)throw new Error("aes/gcm: empty nonce");function r(t,e,r){const o=Bn(Ge,!1,t,r,n);for(let t=0;t<e.length;t++)o[t]^=e[t];return o}function o(){const n=hn(t),r=tn.slice(),o=tn.slice();if(bn(n,!1,o,o,r),12===e.length)o.set(e);else{const t=tn.slice();De(_e(t),8,BigInt(8*e.length),!1),Ge.create(r).update(e).update(t).digestInto(o)}return{xk:n,authKey:r,counter:o,tagMask:bn(n,!1,o,tn)}}return{encrypt:t=>{Ne(t);const{xk:e,authKey:n,counter:i,tagMask:s}=o(),a=new Uint8Array(t.length+16);bn(e,!1,i,t,a);const c=r(n,s,a.subarray(0,a.length-16));return a.set(c,t.length),e.fill(0),a},decrypt:t=>{if(Ne(t),t.length<16)throw new Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:e,authKey:n,counter:i,tagMask:s}=o(),a=t.subarray(0,-16),c=t.subarray(-16);if(!qe(r(n,s,a),c))throw new Error("aes/gcm: invalid ghash tag");const u=bn(e,!1,i,a);return n.fill(0),s.fill(0),e.fill(0),u}}});const Sn=(t,e,n)=>r=>{if(!Number.isSafeInteger(r)||e>r||r>n)throw new Error(`${t}: invalid value=${r}, must be [${e}..${n}]`)};ze({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){const r=Sn("AAD",0,2**36),o=Sn("plaintext",0,2**36),i=Sn("nonce",12,12),s=Sn("ciphertext",16,2**36+16);function a(){const n=t.length;if(16!==n&&24!==n&&32!==n)throw new Error(`key length must be 16, 24 or 32 bytes, got: ${n} bytes`);const r=hn(t),o=new Uint8Array(n),i=new Uint8Array(16),s=Me(e);let a=0,c=s[0],u=s[1],l=s[2],f=0;for(const t of[i,o].map(Me)){const e=Me(t);for(let t=0;t<e.length;t+=2){const{s0:n,s1:o}=yn(r,a,c,u,l);e[t+0]=n,e[t+1]=o,a=++f}}return r.fill(0),{authKey:i,encKey:hn(o)}}function c(t,r,o){const i=Bn(Qe,!0,r,o,n);for(let t=0;t<12;t++)i[t]^=e[t];i[15]&=127;const s=Me(i);let a=s[0],c=s[1],u=s[2],l=s[3];return({s0:a,s1:c,s2:u,s3:l}=yn(t,a,c,u,l)),s[0]=a,s[1]=c,s[2]=u,s[3]=l,i}function u(t,e,n){let r=e.slice();return r[15]|=128,bn(t,!0,r,n)}return Ne(e),i(e.length),n&&(Ne(n),r(n.length)),{encrypt:t=>{Ne(t),o(t.length);const{encKey:e,authKey:n}=a(),r=c(e,n,t),i=new Uint8Array(t.length+16);return i.set(r,t.length),i.set(u(e,r,t)),e.fill(0),n.fill(0),i},decrypt:t=>{Ne(t),s(t.length);const e=t.subarray(-16),{encKey:n,authKey:r}=a(),o=u(n,e,t.subarray(0,-16)),i=c(n,r,o);if(n.fill(0),r.fill(0),!qe(e,i))throw new Error("invalid polyval tag");return o}}});const kn=(t,e)=>255&t[e++]|(255&t[e++])<<8;class Un{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Ne(t=He(t),32);const e=kn(t,0),n=kn(t,2),r=kn(t,4),o=kn(t,6),i=kn(t,8),s=kn(t,10),a=kn(t,12),c=kn(t,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|n<<3),this.r[2]=7939&(n>>>10|r<<6),this.r[3]=8191&(r>>>7|o<<9),this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,this.r[6]=8191&(i>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let e=0;e<8;e++)this.pad[e]=kn(t,16+2*e)}process(t,e,n=!1){const r=n?0:2048,{h:o,r:i}=this,s=i[0],a=i[1],c=i[2],u=i[3],l=i[4],f=i[5],h=i[6],d=i[7],g=i[8],p=i[9],y=kn(t,e+0),w=kn(t,e+2),m=kn(t,e+4),b=kn(t,e+6),E=kn(t,e+8),v=kn(t,e+10),x=kn(t,e+12),A=kn(t,e+14);let I=o[0]+(8191&y),B=o[1]+(8191&(y>>>13|w<<3)),S=o[2]+(8191&(w>>>10|m<<6)),k=o[3]+(8191&(m>>>7|b<<9)),U=o[4]+(8191&(b>>>4|E<<12)),L=o[5]+(E>>>1&8191),T=o[6]+(8191&(E>>>14|v<<2)),C=o[7]+(8191&(v>>>11|x<<5)),R=o[8]+(8191&(x>>>8|A<<8)),N=o[9]+(A>>>5|r),P=0,$=P+I*s+B*(5*p)+S*(5*g)+k*(5*d)+U*(5*h);P=$>>>13,$&=8191,$+=L*(5*f)+T*(5*l)+C*(5*u)+R*(5*c)+N*(5*a),P+=$>>>13,$&=8191;let O=P+I*a+B*s+S*(5*p)+k*(5*g)+U*(5*d);P=O>>>13,O&=8191,O+=L*(5*h)+T*(5*f)+C*(5*l)+R*(5*u)+N*(5*c),P+=O>>>13,O&=8191;let M=P+I*c+B*a+S*s+k*(5*p)+U*(5*g);P=M>>>13,M&=8191,M+=L*(5*d)+T*(5*h)+C*(5*f)+R*(5*l)+N*(5*u),P+=M>>>13,M&=8191;let _=P+I*u+B*c+S*a+k*s+U*(5*p);P=_>>>13,_&=8191,_+=L*(5*g)+T*(5*d)+C*(5*h)+R*(5*f)+N*(5*l),P+=_>>>13,_&=8191;let H=P+I*l+B*u+S*c+k*a+U*s;P=H>>>13,H&=8191,H+=L*(5*p)+T*(5*g)+C*(5*d)+R*(5*h)+N*(5*f),P+=H>>>13,H&=8191;let q=P+I*f+B*l+S*u+k*c+U*a;P=q>>>13,q&=8191,q+=L*s+T*(5*p)+C*(5*g)+R*(5*d)+N*(5*h),P+=q>>>13,q&=8191;let z=P+I*h+B*f+S*l+k*u+U*c;P=z>>>13,z&=8191,z+=L*a+T*s+C*(5*p)+R*(5*g)+N*(5*d),P+=z>>>13,z&=8191;let D=P+I*d+B*h+S*f+k*l+U*u;P=D>>>13,D&=8191,D+=L*c+T*a+C*s+R*(5*p)+N*(5*g),P+=D>>>13,D&=8191;let F=P+I*g+B*d+S*h+k*f+U*l;P=F>>>13,F&=8191,F+=L*u+T*c+C*a+R*s+N*(5*p),P+=F>>>13,F&=8191;let K=P+I*p+B*g+S*d+k*h+U*f;P=K>>>13,K&=8191,K+=L*l+T*u+C*c+R*a+N*s,P+=K>>>13,K&=8191,P=(P<<2)+P|0,P=P+$|0,$=8191&P,P>>>=13,O+=P,o[0]=$,o[1]=O,o[2]=M,o[3]=_,o[4]=H,o[5]=q,o[6]=z,o[7]=D,o[8]=F,o[9]=K}finalize(){const{h:t,pad:e}=this,n=new Uint16Array(10);let r=t[1]>>>13;t[1]&=8191;for(let e=2;e<10;e++)t[e]+=r,r=t[e]>>>13,t[e]&=8191;t[0]+=5*r,r=t[0]>>>13,t[0]&=8191,t[1]+=r,r=t[1]>>>13,t[1]&=8191,t[2]+=r,n[0]=t[0]+5,r=n[0]>>>13,n[0]&=8191;for(let e=1;e<10;e++)n[e]=t[e]+r,r=n[e]>>>13,n[e]&=8191;n[9]-=8192;let o=(1^r)-1;for(let t=0;t<10;t++)n[t]&=o;o=~o;for(let e=0;e<10;e++)t[e]=t[e]&o|n[e];t[0]=65535&(t[0]|t[1]<<13),t[1]=65535&(t[1]>>>3|t[2]<<10),t[2]=65535&(t[2]>>>6|t[3]<<7),t[3]=65535&(t[3]>>>9|t[4]<<4),t[4]=65535&(t[4]>>>12|t[5]<<1|t[6]<<14),t[5]=65535&(t[6]>>>2|t[7]<<11),t[6]=65535&(t[7]>>>5|t[8]<<8),t[7]=65535&(t[8]>>>8|t[9]<<5);let i=t[0]+e[0];t[0]=65535&i;for(let n=1;n<8;n++)i=(t[n]+e[n]|0)+(i>>>16)|0,t[n]=65535&i}update(t){Pe(this);const{buffer:e,blockLen:n}=this,r=(t=He(t)).length;for(let o=0;o<r;){const i=Math.min(n-this.pos,r-o);if(i!==n)e.set(t.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===n&&(this.process(e,0,!1),this.pos=0);else for(;n<=r-o;o+=n)this.process(t,o)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){Pe(this),$e(t,this),this.finished=!0;const{buffer:e,h:n}=this;let{pos:r}=this;if(r){for(e[r++]=1;r<16;r++)e[r]=0;this.process(e,0,!0)}this.finalize();let o=0;for(let e=0;e<8;e++)t[o++]=n[e]>>>0,t[o++]=n[e]>>>8;return t}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}}const Ln=function(t){const e=(e,n)=>t(n).update(He(e)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e}(t=>new Un(t)),Tn=t=>Uint8Array.from(t.split("").map(t=>t.charCodeAt(0))),Cn=Tn("expand 16-byte k"),Rn=Tn("expand 32-byte k"),Nn=Me(Cn),Pn=Me(Rn);function $n(t,e){return t<<e|t>>>32-e}function On(t){return t.byteOffset%4==0}Pn.slice();const Mn=2**32-1,_n=new Uint32Array;function Hn(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=function(t,e){if(null==e||"object"!=typeof e)throw new Error("options must be defined");return Object.assign({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e)}(0,e);if("function"!=typeof t)throw new Error("core must be a function");return Te(o),Te(s),Ce(i),Ce(n),(e,a,c,u,l=0)=>{Ne(e),Ne(a),Ne(c);const f=c.length;if(u||(u=new Uint8Array(f)),Ne(u),Te(l),l<0||l>=Mn)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const h=[];let d,g,p=e.length;if(32===p)d=e.slice(),h.push(d),g=Pn;else{if(16!==p||!n)throw new Error(`arx: invalid 32-byte key, got length=${p}`);d=new Uint8Array(32),d.set(e),d.set(e,16),g=Nn,h.push(d)}On(a)||(a=a.slice(),h.push(a));const y=Me(d);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(g,y,Me(a.subarray(0,16)),y),a=a.subarray(16)}const w=16-o;if(w!==a.length)throw new Error(`arx: nonce must be ${w} or 16 bytes`);if(12!==w){const t=new Uint8Array(12);t.set(a,i?0:12-a.length),a=t,h.push(a)}const m=Me(a);for(function(t,e,n,r,o,i,s,a){const c=o.length,u=new Uint8Array(64),l=Me(u),f=On(o)&&On(i),h=f?Me(o):_n,d=f?Me(i):_n;for(let g=0;g<c;s++){if(t(e,n,r,l,s,a),s>=Mn)throw new Error("arx: counter overflow");const p=Math.min(64,c-g);if(f&&64===p){const t=g/4;if(g%4!=0)throw new Error("arx: invalid block position");for(let e,n=0;n<16;n++)e=t+n,d[e]=h[e]^l[n];g+=64;continue}for(let t,e=0;e<p;e++)t=g+e,i[t]=o[t]^u[e];g+=p}}(t,g,y,m,c,u,l,s);h.length>0;)h.pop().fill(0);return u}}function qn(t,e,n,r,o,i=20){let s=t[0],a=t[1],c=t[2],u=t[3],l=e[0],f=e[1],h=e[2],d=e[3],g=e[4],p=e[5],y=e[6],w=e[7],m=o,b=n[0],E=n[1],v=n[2],x=s,A=a,I=c,B=u,S=l,k=f,U=h,L=d,T=g,C=p,R=y,N=w,P=m,$=b,O=E,M=v;for(let t=0;t<i;t+=2)x=x+S|0,P=$n(P^x,16),T=T+P|0,S=$n(S^T,12),x=x+S|0,P=$n(P^x,8),T=T+P|0,S=$n(S^T,7),A=A+k|0,$=$n($^A,16),C=C+$|0,k=$n(k^C,12),A=A+k|0,$=$n($^A,8),C=C+$|0,k=$n(k^C,7),I=I+U|0,O=$n(O^I,16),R=R+O|0,U=$n(U^R,12),I=I+U|0,O=$n(O^I,8),R=R+O|0,U=$n(U^R,7),B=B+L|0,M=$n(M^B,16),N=N+M|0,L=$n(L^N,12),B=B+L|0,M=$n(M^B,8),N=N+M|0,L=$n(L^N,7),x=x+k|0,M=$n(M^x,16),R=R+M|0,k=$n(k^R,12),x=x+k|0,M=$n(M^x,8),R=R+M|0,k=$n(k^R,7),A=A+U|0,P=$n(P^A,16),N=N+P|0,U=$n(U^N,12),A=A+U|0,P=$n(P^A,8),N=N+P|0,U=$n(U^N,7),I=I+L|0,$=$n($^I,16),T=T+$|0,L=$n(L^T,12),I=I+L|0,$=$n($^I,8),T=T+$|0,L=$n(L^T,7),B=B+S|0,O=$n(O^B,16),C=C+O|0,S=$n(S^C,12),B=B+S|0,O=$n(O^B,8),C=C+O|0,S=$n(S^C,7);let _=0;r[_++]=s+x|0,r[_++]=a+A|0,r[_++]=c+I|0,r[_++]=u+B|0,r[_++]=l+S|0,r[_++]=f+k|0,r[_++]=h+U|0,r[_++]=d+L|0,r[_++]=g+T|0,r[_++]=p+C|0,r[_++]=y+R|0,r[_++]=w+N|0,r[_++]=m+P|0,r[_++]=b+$|0,r[_++]=E+O|0,r[_++]=v+M|0}const zn=Hn(qn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Dn=Hn(qn,{counterRight:!1,counterLength:8,extendNonceFn:function(t,e,n,r){let o=t[0],i=t[1],s=t[2],a=t[3],c=e[0],u=e[1],l=e[2],f=e[3],h=e[4],d=e[5],g=e[6],p=e[7],y=n[0],w=n[1],m=n[2],b=n[3];for(let t=0;t<20;t+=2)o=o+c|0,y=$n(y^o,16),h=h+y|0,c=$n(c^h,12),o=o+c|0,y=$n(y^o,8),h=h+y|0,c=$n(c^h,7),i=i+u|0,w=$n(w^i,16),d=d+w|0,u=$n(u^d,12),i=i+u|0,w=$n(w^i,8),d=d+w|0,u=$n(u^d,7),s=s+l|0,m=$n(m^s,16),g=g+m|0,l=$n(l^g,12),s=s+l|0,m=$n(m^s,8),g=g+m|0,l=$n(l^g,7),a=a+f|0,b=$n(b^a,16),p=p+b|0,f=$n(f^p,12),a=a+f|0,b=$n(b^a,8),p=p+b|0,f=$n(f^p,7),o=o+u|0,b=$n(b^o,16),g=g+b|0,u=$n(u^g,12),o=o+u|0,b=$n(b^o,8),g=g+b|0,u=$n(u^g,7),i=i+l|0,y=$n(y^i,16),p=p+y|0,l=$n(l^p,12),i=i+l|0,y=$n(y^i,8),p=p+y|0,l=$n(l^p,7),s=s+f|0,w=$n(w^s,16),h=h+w|0,f=$n(f^h,12),s=s+f|0,w=$n(w^s,8),h=h+w|0,f=$n(f^h,7),a=a+c|0,m=$n(m^a,16),d=d+m|0,c=$n(c^d,12),a=a+c|0,m=$n(m^a,8),d=d+m|0,c=$n(c^d,7);let E=0;r[E++]=o,r[E++]=i,r[E++]=s,r[E++]=a,r[E++]=y,r[E++]=w,r[E++]=m,r[E++]=b},allowShortKeys:!1}),Fn=new Uint8Array(16),Kn=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(Fn.subarray(n))},jn=new Uint8Array(32);function Vn(t,e,n,r,o){const i=t(e,n,jn),s=Ln.create(i);o&&Kn(s,o),Kn(s,r);const a=new Uint8Array(16),c=_e(a);De(c,0,BigInt(o?o.length:0),!0),De(c,8,BigInt(r.length),!0),s.update(a);const u=s.digest();return i.fill(0),u}const Wn=t=>(e,n,r)=>(Ne(e,32),Ne(n),{encrypt:(o,i)=>{const s=o.length,a=s+16;i?Ne(i,a):i=new Uint8Array(a),t(e,n,o,i,1);const c=Vn(t,e,n,i.subarray(0,-16),r);return i.set(c,s),i},decrypt:(o,i)=>{const s=o.length,a=s-16;if(s<16)throw new Error("encrypted data must be at least 16 bytes");i?Ne(i,a):i=new Uint8Array(a);const c=o.subarray(0,-16);if(!qe(o.subarray(-16),Vn(t,e,n,c,r)))throw new Error("invalid tag");return t(e,n,c,i,1),i}});Wn(zn),Wn(Dn);class Jn extends Zt{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,te.hash(t);const n=Wt(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return te.exists(this),this.iHash.update(t),this}digestInto(t){te.exists(this),te.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Zn=(t,e,n)=>new Jn(t,e).update(n).digest();Zn.create=(t,e)=>new Jn(t,e);const Yn=new Uint8Array([0]),Gn=new Uint8Array;var Qn=Object.defineProperty,Xn=(t,e)=>{for(var n in e)Qn(t,n,{get:e[n],enumerable:!0})},tr=Symbol("verified");function er(t){if(!(t instanceof Object))return!1;if("number"!=typeof t.kind)return!1;if("string"!=typeof t.content)return!1;if("number"!=typeof t.created_at)return!1;if("string"!=typeof t.pubkey)return!1;if(!t.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let t=0;t<n.length;t++)if("string"!=typeof n[t])return!1}return!0}Xn({},{Queue:()=>ur,QueueNode:()=>cr,binarySearch:()=>ar,bytesToHex:()=>jt,hexToBytes:()=>Vt,insertEventIntoAscendingList:()=>sr,insertEventIntoDescendingList:()=>ir,normalizeURL:()=>or,utf8Decoder:()=>nr,utf8Encoder:()=>rr});var nr=new TextDecoder("utf-8"),rr=new TextEncoder;function or(t){try{-1===t.indexOf("://")&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch(e){throw new Error(`Invalid URL: ${t}`)}}function ir(t,e){const[n,r]=ar(t,t=>e.id===t.id?0:e.created_at===t.created_at?-1:t.created_at-e.created_at);return r||t.splice(n,0,e),t}function sr(t,e){const[n,r]=ar(t,t=>e.id===t.id?0:e.created_at===t.created_at?-1:e.created_at-t.created_at);return r||t.splice(n,0,e),t}function ar(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=e(t[o]);if(0===i)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var cr=class{value;next=null;prev=null;constructor(t){this.value=t}},ur=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new cr(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}};function lr(t){return jt(ue(rr.encode(function(t){if(!er(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t))))}var fr=new class{generateSecretKey(){return Ht.utils.randomPrivateKey()}getPublicKey(t){return jt(Ht.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=jt(Ht.getPublicKey(e)),n.id=lr(n),n.sig=jt(Ht.sign(lr(n),e)),n[tr]=!0,n}verifyEvent(t){if("boolean"==typeof t[tr])return t[tr];const e=lr(t);if(e!==t.id)return t[tr]=!1,!1;try{const n=Ht.verify(t.sig,e,t.pubkey);return t[tr]=n,n}catch(e){return t[tr]=!1,!1}}},hr=fr.generateSecretKey,dr=fr.getPublicKey,gr=fr.finalizeEvent,pr=fr.verifyEvent;function yr(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function wr(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function mr(t){return 2e4<=t&&t<3e4}function br(t){return 3e4<=t&&t<4e4}function Er(t){return yr(t)?"regular":wr(t)?"replaceable":mr(t)?"ephemeral":br(t)?"parameterized":"unknown"}function vr(t,e){const n=e instanceof Array?e:[e];return er(t)&&n.includes(t.kind)||!1}Xn({},{Application:()=>Po,BadgeAward:()=>Tr,BadgeDefinition:()=>ko,BlockedRelaysList:()=>ao,BookmarkList:()=>oo,Bookmarksets:()=>Io,Calendar:()=>zo,CalendarEventRSVP:()=>Do,ChannelCreation:()=>Pr,ChannelHideMessage:()=>Mr,ChannelMessage:()=>Or,ChannelMetadata:()=>$r,ChannelMuteUser:()=>_r,ClassifiedListing:()=>Mo,ClientAuth:()=>yo,CommunitiesList:()=>io,CommunityDefinition:()=>jo,CommunityPostApproval:()=>Wr,Contacts:()=>Br,CreateOrUpdateProduct:()=>To,CreateOrUpdateStall:()=>Lo,Curationsets:()=>Bo,Date:()=>Ho,DirectMessageRelaysList:()=>fo,DraftClassifiedListing:()=>_o,DraftLong:()=>Ro,Emojisets:()=>No,EncryptedDirectMessage:()=>Sr,EventDeletion:()=>kr,FileMetadata:()=>zr,FileServerPreference:()=>ho,Followsets:()=>vo,GenericRepost:()=>Nr,Genericlists:()=>xo,GiftWrap:()=>qr,HTTPAuth:()=>Eo,Handlerinformation:()=>Ko,Handlerrecommendation:()=>Fo,Highlights:()=>to,InterestsList:()=>uo,Interestsets:()=>Uo,JobFeedback:()=>Yr,JobRequest:()=>Jr,JobResult:()=>Zr,Label:()=>Vr,LightningPubRPC:()=>po,LiveChatMessage:()=>Dr,LiveEvent:()=>$o,LongFormArticle:()=>Co,Metadata:()=>xr,Mutelist:()=>eo,NWCWalletInfo:()=>go,NWCWalletRequest:()=>wo,NWCWalletResponse:()=>mo,NostrConnect:()=>bo,OpenTimestamps:()=>Hr,Pinlist:()=>no,PrivateDirectMessage:()=>Rr,ProblemTracker:()=>Fr,ProfileBadges:()=>So,PublicChatsList:()=>so,Reaction:()=>Lr,RecommendRelay:()=>Ir,RelayList:()=>ro,Relaysets:()=>Ao,Report:()=>Kr,Reporting:()=>jr,Repost:()=>Ur,Seal:()=>Cr,SearchRelaysList:()=>co,ShortTextNote:()=>Ar,Time:()=>qo,UserEmojiList:()=>lo,UserStatuses:()=>Oo,Zap:()=>Xr,ZapGoal:()=>Gr,ZapRequest:()=>Qr,classifyKind:()=>Er,isAddressableKind:()=>br,isEphemeralKind:()=>mr,isKind:()=>vr,isRegularKind:()=>yr,isReplaceableKind:()=>wr});var xr=0,Ar=1,Ir=2,Br=3,Sr=4,kr=5,Ur=6,Lr=7,Tr=8,Cr=13,Rr=14,Nr=16,Pr=40,$r=41,Or=42,Mr=43,_r=44,Hr=1040,qr=1059,zr=1063,Dr=1311,Fr=1971,Kr=1984,jr=1984,Vr=1985,Wr=4550,Jr=5999,Zr=6999,Yr=7e3,Gr=9041,Qr=9734,Xr=9735,to=9802,eo=1e4,no=10001,ro=10002,oo=10003,io=10004,so=10005,ao=10006,co=10007,uo=10015,lo=10030,fo=10050,ho=10096,go=13194,po=21e3,yo=22242,wo=23194,mo=23195,bo=24133,Eo=27235,vo=3e4,xo=30001,Ao=30002,Io=30003,Bo=30004,So=30008,ko=30009,Uo=30015,Lo=30017,To=30018,Co=30023,Ro=30024,No=30030,Po=30078,$o=30311,Oo=30315,Mo=30402,_o=30403,Ho=31922,qo=31923,zo=31924,Do=31925,Fo=31989,Ko=31990,jo=34550;function Vo(t,e){if(t.ids&&-1===t.ids.indexOf(e.id))return!1;if(t.kinds&&-1===t.kinds.indexOf(e.kind))return!1;if(t.authors&&-1===t.authors.indexOf(e.pubkey))return!1;for(let n in t)if("#"===n[0]){let r=t[`#${n.slice(1)}`];if(r&&!e.tags.find(([t,e])=>t===n.slice(1)&&-1!==r.indexOf(e)))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function Wo(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function Jo(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function Zo(t){let e=t.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let n=t.slice(e+7+1).indexOf('"');if(-1===n)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return t.slice(r+1,i)}function Yo(t,e){return e===Wo(t,"id")}function Go(t,e){return e===Wo(t,"pubkey")}function Qo(t,e){return e===Jo(t,"kind")}function Xo(t,e){return{kind:yo,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}async function ti(){return new Promise(t=>{const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()})}Xn({},{getHex64:()=>Wo,getInt:()=>Jo,getSubscriptionId:()=>Zo,matchEventId:()=>Yo,matchEventKind:()=>Qo,matchEventPubkey:()=>Go}),Xn({},{makeAuthEvent:()=>Xo});var ei=t=>(t[tr]=!0,!0),ni=class extends Error{constructor(t,e){super(`Tried to send message '${t} on a closed connection to ${e}.`),this.name="SendingOnClosedConnection"}},ri=class{url;_connected=!1;onclose=null;onnotice=t=>console.debug(`NOTICE from ${this.url}: ${t}`);baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;pingFrequency=2e4;pingTimeout=2e4;openSubs=new Map;enablePing;connectionTimeoutHandle;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new ur;queueRunning=!1;challenge;authPromise;serial=0;verifyEvent;_WebSocket;constructor(t,e){this.url=or(t),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation||WebSocket,this.enablePing=e.enablePing}static async connect(t,e){const n=new ri(t,e);return await n.connect(),n}closeAllSubscriptions(t){for(let[e,n]of this.openSubs)n.close(t);this.openSubs.clear();for(let[e,n]of this.openEventPublishes)n.reject(new Error(t));this.openEventPublishes.clear();for(let[e,n]of this.openCountRequests)n.reject(new Error(t));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise||(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((t,e)=>{this.connectionTimeoutHandle=setTimeout(()=>{e("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(t){return clearTimeout(this.connectionTimeoutHandle),void e(t)}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,this.enablePing&&this.pingpong(),t()},this.ws.onerror=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket closed"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)})),this.connectionPromise}async waitForPingPong(){return new Promise((t,e)=>{this.ws&&this.ws.on&&this.ws.on("pong",()=>t(!0))||e("ws can't listen for pong"),this.ws&&this.ws.ping&&this.ws.ping()})}async waitForDummyReq(){return new Promise((t,e)=>{const n=this.subscribe([{ids:["a".repeat(64)]}],{oneose:()=>{n.close(),t(!0)},eoseTimeout:this.pingTimeout+1e3})})}async pingpong(){1===this.ws?.readyState&&(await Promise.any([this.ws&&this.ws.ping&&this.ws.on?this.waitForPingPong():this.waitForDummyReq(),new Promise(t=>setTimeout(()=>t(!1),this.pingTimeout))])?setTimeout(()=>this.pingpong(),this.pingFrequency):(this.closeAllSubscriptions("pingpong timed out"),this._connected=!1,this.ws?.close(),this.onclose?.()))}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await ti();this.queueRunning=!1}handleNext(){const t=this.incomingMessageQueue.dequeue();if(!t)return!1;const e=Zo(t);if(e){const n=this.openSubs.get(e);if(!n)return;const r=Wo(t,"id"),o=n.alreadyHaveEvent?.(r);if(n.receivedEvent?.(this,r),o)return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{const t=this.openSubs.get(e[1]),n=e[2];return void(this.verifyEvent(n)&&function(t,e){for(let n=0;n<t.length;n++)if(Vo(t[n],e))return!0;return!1}(t.filters,n)&&t.onevent(n))}case"COUNT":{const t=e[1],n=e[2],r=this.openCountRequests.get(t);return void(r&&(r.resolve(n.count),this.openCountRequests.delete(t)))}case"EOSE":{const t=this.openSubs.get(e[1]);if(!t)return;return void t.receivedEose()}case"OK":{const t=e[1],n=e[2],r=e[3],o=this.openEventPublishes.get(t);return void(o&&(clearTimeout(o.timeout),n?o.resolve(r):o.reject(new Error(r)),this.openEventPublishes.delete(t)))}case"CLOSED":{const t=e[1],n=this.openSubs.get(t);if(!n)return;return n.closed=!0,void n.close(e[2])}case"NOTICE":return void this.onnotice(e[1]);case"AUTH":return void(this.challenge=e[1])}}catch(t){return}}async send(t){if(!this.connectionPromise)throw new ni(t,this.url);this.connectionPromise.then(()=>{this.ws?.send(t)})}async auth(t){const e=this.challenge;if(!e)throw new Error("can't perform auth, no challenge was received");return this.authPromise||(this.authPromise=new Promise(async(n,r)=>{try{let o=await t(Xo(this.url,e)),i=setTimeout(()=>{let t=this.openEventPublishes.get(o.id);t&&(t.reject(new Error("auth timed out")),this.openEventPublishes.delete(o.id))},this.publishTimeout);this.openEventPublishes.set(o.id,{resolve:n,reject:r,timeout:i}),this.send('["AUTH",'+JSON.stringify(o)+"]")}catch(t){console.warn("subscribe auth function failed:",t)}})),this.authPromise}async publish(t){const e=new Promise((e,n)=>{const r=setTimeout(()=>{const e=this.openEventPublishes.get(t.id);e&&(e.reject(new Error("publish timed out")),this.openEventPublishes.delete(t.id))},this.publishTimeout);this.openEventPublishes.set(t.id,{resolve:e,reject:n,timeout:r})});return this.send('["EVENT",'+JSON.stringify(t)+"]"),e}async count(t,e){this.serial++;const n=e?.id||"count:"+this.serial,r=new Promise((t,e)=>{this.openCountRequests.set(n,{resolve:t,reject:e})});return this.send('["COUNT","'+n+'",'+JSON.stringify(t).substring(1)),r}subscribe(t,e){const n=this.prepareSubscription(t,e);return n.fire(),n}prepareSubscription(t,e){this.serial++;const n=e.id||(e.label?e.label+":":"sub:")+this.serial,r=new oi(this,n,t,e);return this.openSubs.set(n,r),r}close(){this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.ws?.close(),this.onclose?.()}_onmessage(t){this.incomingMessageQueue.enqueue(t.data),this.queueRunning||this.runQueue()}},oi=class{relay;id;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;eoseTimeout;eoseTimeoutHandle;constructor(t,e,n,r){this.relay=t,this.filters=n,this.id=e,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||t.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(t=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,t)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(t="closed by caller"){if(!this.closed&&this.relay.connected){try{this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]")}catch(t){if(!(t instanceof ni))throw t}this.closed=!0}this.relay.openSubs.delete(this.id),this.onclose?.(t)}};try{WebSocket}catch{}var ii,si=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;enablePing;trustedRelayURLs=new Set;_WebSocket;constructor(t){this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation,this.enablePing=t.enablePing}async ensureRelay(t,e){t=or(t);let n=this.relays.get(t);return n||(n=new ri(t,{verifyEvent:this.trustedRelayURLs.has(t)?ei:this.verifyEvent,websocketImplementation:this._WebSocket,enablePing:this.enablePing}),n.onclose=()=>{this.relays.delete(t)},e?.connectionTimeout&&(n.connectionTimeout=e.connectionTimeout),this.relays.set(t,n)),await n.connect(),n}close(t){t.map(or).forEach(t=>{this.relays.get(t)?.close(),this.relays.delete(t)})}subscribe(t,e,n){n.onauth=n.onauth||n.doauth;const r=[];for(let n=0;n<t.length;n++){const o=or(t[n]);r.find(t=>t.url===o)||r.push({url:o,filter:e})}return this.subscribeMap(r,n)}subscribeMany(t,e,n){n.onauth=n.onauth||n.doauth;const r=[],o=[];for(let n=0;n<t.length;n++){const i=or(t[n]);if(-1===o.indexOf(i))for(let t=0;t<e.length;t++)r.push({url:i,filter:e[t]})}return this.subscribeMap(r,n)}subscribeMap(t,e){e.onauth=e.onauth||e.doauth,this.trackRelays&&(e.receivedEvent=(t,e)=>{let n=this.seenOn.get(e);n||(n=new Set,this.seenOn.set(e,n)),n.add(t)});const n=new Set,r=[],o=[];let i=n=>{o[n]||(o[n]=!0,o.filter(t=>t).length===t.length&&(e.oneose?.(),i=()=>{}))};const s=[];let a=(n,r)=>{s[n]||(i(n),s[n]=r,s.filter(t=>t).length===t.length&&(e.onclose?.(s),a=()=>{}))};const c=t=>{if(e.alreadyHaveEvent?.(t))return!0;const r=n.has(t);return n.add(t),r},u=Promise.all(t.map(async({url:t,filter:n},o)=>{let s;try{s=await this.ensureRelay(t,{connectionTimeout:e.maxWait?Math.max(.8*e.maxWait,e.maxWait-1e3):void 0})}catch(t){return void a(o,t?.message||String(t))}let u=s.subscribe([n],{...e,oneose:()=>i(o),onclose:t=>{t.startsWith("auth-required: ")&&e.onauth?s.auth(e.onauth).then(()=>{s.subscribe([n],{...e,oneose:()=>i(o),onclose:t=>{a(o,t)},alreadyHaveEvent:c,eoseTimeout:e.maxWait})}).catch(t=>{a(o,`auth was required and attempted, but failed with: ${t}`)}):a(o,t)},alreadyHaveEvent:c,eoseTimeout:e.maxWait});r.push(u)}));return{async close(t){await u,r.forEach(e=>{e.close(t)})}}}subscribeEose(t,e,n){n.onauth=n.onauth||n.doauth;const r=this.subscribe(t,e,{...n,oneose(){r.close("closed automatically on eose")}});return r}subscribeManyEose(t,e,n){n.onauth=n.onauth||n.doauth;const r=this.subscribeMany(t,e,{...n,oneose(){r.close("closed automatically on eose")}});return r}async querySync(t,e,n){return new Promise(async r=>{const o=[];this.subscribeEose(t,e,{...n,onevent(t){o.push(t)},onclose(t){r(o)}})})}async get(t,e,n){e.limit=1;const r=await this.querySync(t,e,n);return r.sort((t,e)=>e.created_at-t.created_at),r[0]||null}publish(t,e,n){return t.map(or).map(async(t,r,o)=>{if(o.indexOf(t)!==r)return Promise.reject("duplicate url");let i=await this.ensureRelay(t);return i.publish(e).catch(async t=>{if(t instanceof Error&&t.message.startsWith("auth-required: ")&&n?.onauth)return await i.auth(n.onauth),i.publish(e);throw t}).then(t=>{if(this.trackRelays){let t=this.seenOn.get(e.id);t||(t=new Set,this.seenOn.set(e.id,t)),t.add(i)}return t})})}listConnectionStatus(){const t=new Map;return this.relays.forEach((e,n)=>t.set(n,e.connected)),t}destroy(){this.relays.forEach(t=>t.close()),this.relays=new Map}};try{ii=WebSocket}catch{}var ai=class extends si{constructor(t){super({verifyEvent:pr,websocketImplementation:ii,...t})}};Xn({},{BECH32_REGEX:()=>li,Bech32MaxSize:()=>ui,NostrTypeGuard:()=>ci,decode:()=>hi,decodeNostrURI:()=>fi,encodeBytes:()=>mi,naddrEncode:()=>vi,neventEncode:()=>Ei,noteEncode:()=>yi,nprofileEncode:()=>bi,npubEncode:()=>pi,nsecEncode:()=>gi});var ci={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},ui=5e3,li=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function fi(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),hi(t)}catch(t){return{type:"invalid",data:null}}}function hi(t){let{prefix:e,words:n}=Le.decode(t,ui),r=new Uint8Array(Le.fromWords(n));switch(e){case"nprofile":{let t=di(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:jt(t[0][0]),relays:t[1]?t[1].map(t=>nr.decode(t)):[]}}}case"nevent":{let t=di(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(t[2]&&32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(t[3]&&4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:jt(t[0][0]),relays:t[1]?t[1].map(t=>nr.decode(t)):[],author:t[2]?.[0]?jt(t[2][0]):void 0,kind:t[3]?.[0]?parseInt(jt(t[3][0]),16):void 0}}}case"naddr":{let t=di(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!t[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!t[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:nr.decode(t[0][0]),pubkey:jt(t[2][0]),kind:parseInt(jt(t[3][0]),16),relays:t[1]?t[1].map(t=>nr.decode(t)):[]}}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:jt(r)};default:throw new Error(`unknown prefix ${e}`)}}function di(t){let e={},n=t;for(;n.length>0;){let t=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${t}`);e[t]=e[t]||[],e[t].push(o)}return e}function gi(t){return mi("nsec",t)}function pi(t){return mi("npub",Vt(t))}function yi(t){return mi("note",Vt(t))}function wi(t,e){let n=Le.toWords(e);return Le.encode(t,n,ui)}function mi(t,e){return wi(t,e)}function bi(t){return wi("nprofile",xi({0:[Vt(t.pubkey)],1:(t.relays||[]).map(t=>rr.encode(t))}))}function Ei(t){let e;return void 0!==t.kind&&(e=function(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=255&t,e}(t.kind)),wi("nevent",xi({0:[Vt(t.id)],1:(t.relays||[]).map(t=>rr.encode(t)),2:t.author?[Vt(t.author)]:[],3:e?[new Uint8Array(e)]:[]}))}function vi(t){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t.kind,!1),wi("naddr",xi({0:[rr.encode(t.identifier)],1:(t.relays||[]).map(t=>rr.encode(t)),2:[Vt(t.pubkey)],3:[new Uint8Array(e)]}))}function xi(t){let e=[];return Object.entries(t).reverse().forEach(([t,n])=>{n.forEach(n=>{let r=new Uint8Array(n.length+2);r.set([parseInt(t)],0),r.set([n.length],1),r.set(n,2),e.push(r)})}),Jt(...e)}function Ai(t,e,n){const r=t instanceof Uint8Array?jt(t):t,o=Bi(At.getSharedSecret(r,"02"+e));let i=Uint8Array.from(Gt(16)),s=rr.encode(n),a=In(o,i).encrypt(s);return`${xe.encode(new Uint8Array(a))}?iv=${xe.encode(new Uint8Array(i.buffer))}`}function Ii(t,e,n){const r=t instanceof Uint8Array?jt(t):t;let[o,i]=n.split("?iv="),s=Bi(At.getSharedSecret(r,"02"+e)),a=xe.decode(i),c=xe.decode(o),u=In(s,a).decrypt(c);return nr.decode(u)}function Bi(t){return t.slice(1,33)}Xn({},{decrypt:()=>Ii,encrypt:()=>Ai}),Xn({},{NIP05_REGEX:()=>ki,isNip05:()=>Ui,isValid:()=>Ri,queryProfile:()=>Ci,searchDomain:()=>Ti,useFetchImplementation:()=>Li});var Si,ki=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Ui=t=>ki.test(t||"");try{Si=fetch}catch(t){}function Li(t){Si=t}async function Ti(t,e=""){try{const n=`https://${t}/.well-known/nostr.json?name=${e}`,r=await Si(n,{redirect:"manual"});if(200!==r.status)throw Error("Wrong response code");return(await r.json()).names}catch(t){return{}}}async function Ci(t){const e=t.match(ki);if(!e)return null;const[,n="_",r]=e;try{const t=`https://${r}/.well-known/nostr.json?name=${n}`,e=await Si(t,{redirect:"manual"});if(200!==e.status)throw Error("Wrong response code");const o=await e.json(),i=o.names[n];return i?{pubkey:i,relays:o.relays?.[i]}:null}catch(t){return null}}async function Ri(t,e){const n=await Ci(e);return!!n&&n.pubkey===t}function Ni(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=t.tags.length-1;o>=0;o--){const i=t.tags[o];if("e"===i[0]&&i[1]){const[t,o,s,a,c]=i,u={id:o,relays:s?[s]:[],author:c};if("root"===a){e.root=u;continue}if("reply"===a){e.reply=u;continue}if("mention"===a){e.mentions.push(u);continue}n?r=u:n=u,e.mentions.push(u);continue}if("q"===i[0]&&i[1]){const[t,n,r]=i;e.quotes.push({id:n,relays:r?[r]:[]})}"p"===i[0]&&i[1]&&e.profiles.push({pubkey:i[1],relays:i[2]?[i[2]]:[]})}return e.root||(e.root=r||n||e.reply),e.reply||(e.reply=n||e.root),[e.reply,e.root].forEach(t=>{if(!t)return;let n=e.mentions.indexOf(t);if(-1!==n&&e.mentions.splice(n,1),t.author){let n=e.profiles.find(e=>e.pubkey===t.author);n&&n.relays&&(t.relays||(t.relays=[]),n.relays.forEach(e=>{-1===t.relays?.indexOf(e)&&t.relays.push(e)}),n.relays=t.relays)}}),e.mentions.forEach(t=>{if(t.author){let n=e.profiles.find(e=>e.pubkey===t.author);n&&n.relays&&(t.relays||(t.relays=[]),n.relays.forEach(e=>{-1===t.relays.indexOf(e)&&t.relays.push(e)}),n.relays=t.relays)}}),e}Xn({},{parse:()=>Ni}),Xn({},{fetchRelayInformation:()=>$i,useFetchImplementation:()=>Pi});try{fetch}catch{}function Pi(t){}async function $i(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}function Oi(t){let e=0;for(let n=0;n<64;n+=8){const r=parseInt(t.substring(n,n+8),16);if(0!==r){e+=Math.clz32(r);break}e+=32}return e}function Mi(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const t=Math.floor((new Date).getTime()/1e3);if(t!==r.created_at&&(n=0,r.created_at=t),o[1]=(++n).toString(),r.id=_i(r),Oi(r.id)>=e)break}return r}function _i(t){return jt(ue(rr.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}Xn({},{fastEventHash:()=>_i,getPow:()=>Oi,minePow:()=>Mi}),Xn({},{unwrapEvent:()=>us,unwrapManyEvents:()=>ls,wrapEvent:()=>as,wrapManyEvents:()=>cs}),Xn({},{createRumor:()=>ts,createSeal:()=>es,createWrap:()=>ns,unwrapEvent:()=>is,unwrapManyEvents:()=>ss,wrapEvent:()=>rs,wrapManyEvents:()=>os});var Hi={};Xn(Hi,{decrypt:()=>Wi,encrypt:()=>Vi,getConversationKey:()=>Di,v2:()=>Ji});var qi=1,zi=65535;function Di(t,e){const n=At.getSharedSecret(t,"02"+e).subarray(1,33);return r=ue,o=n,i="nip44-v2",te.hash(r),void 0===i&&(i=new Uint8Array(r.outputLen)),Zn(r,Wt(i),Wt(o));var r,o,i}function Fi(t,e){const n=function(t,e,n,r=32){if(te.hash(t),te.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);void 0===n&&(n=Gn);const i=new Uint8Array(o*t.outputLen),s=Zn.create(t,e),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let e=0;e<o;e++)Yn[0]=e+1,a.update(0===e?Gn:c).update(n).update(Yn).digestInto(c),i.set(c,t.outputLen*e),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),Yn.fill(0),i.slice(0,r)}(ue,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function Ki(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function ji(t,e,n){if(32!==n.length)throw new Error("AAD associated data must be 32 bytes");const r=Jt(n,e);return Zn(ue,t,r)}function Vi(t,e,n=Gt(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=Fi(e,n),s=function(t){const e=rr.encode(t),n=e.length;return Jt(function(t){if(!Number.isSafeInteger(t)||t<qi||t>zi)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}(n),e,new Uint8Array(Ki(n)-n))}(t),a=zn(r,o,s),c=ji(i,a,n);return xe.encode(Jt(new Uint8Array([2]),n,a,c))}function Wi(t,e){const{nonce:n,ciphertext:r,mac:o}=function(t){if("string"!=typeof t)throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if("#"===t[0])throw new Error("unknown encryption version");let n;try{n=xe.decode(t)}catch(t){throw new Error("invalid base64: "+t.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(2!==o)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}(t),{chacha_key:i,chacha_nonce:s,hmac_key:a}=Fi(e,n);if(!qe(ji(a,r,n),o))throw new Error("invalid MAC");return function(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<qi||e>zi||n.length!==e||t.length!==2+Ki(e))throw new Error("invalid padding");return nr.decode(n)}(zn(i,s,r))}var Ji={utils:{getConversationKey:Di,calcPaddedLen:Ki},encrypt:Vi,decrypt:Wi},Zi=()=>Math.round(Date.now()/1e3),Yi=()=>Math.round(Zi()-172800*Math.random()),Gi=(t,e)=>Di(t,e),Qi=(t,e,n)=>Vi(JSON.stringify(t),Gi(e,n)),Xi=(t,e)=>JSON.parse(Wi(t.content,Gi(e,t.pubkey)));function ts(t,e){const n={created_at:Zi(),content:"",tags:[],...t,pubkey:dr(e)};return n.id=lr(n),n}function es(t,e,n){return gr({kind:Cr,content:Qi(t,e,n),created_at:Yi(),tags:[]},e)}function ns(t,e){const n=hr();return gr({kind:qr,content:Qi(t,n,e),created_at:Yi(),tags:[["p",e]]},n)}function rs(t,e,n){return ns(es(ts(t,e),e,n),n)}function os(t,e,n){if(!n||0===n.length)throw new Error("At least one recipient is required.");const r=dr(e),o=[rs(t,e,r)];return n.forEach(n=>{o.push(rs(t,e,n))}),o}function is(t,e){const n=Xi(t,e);return Xi(n,e)}function ss(t,e){let n=[];return t.forEach(t=>{n.push(is(t,e))}),n.sort((t,e)=>t.created_at-e.created_at),n}function as(t,e,n,r,o){const i=function(t,e,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:Rr,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:t,relayUrl:e})=>{o.tags.push(e?["p",t,e]:["p",t])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}(e,n,r,o);return rs(i,t,e.publicKey)}function cs(t,e,n,r,o){if(!e||0===e.length)throw new Error("At least one recipient is required.");return[{publicKey:dr(t)},...e].map(e=>as(t,e,n,r,o))}var us=is,ls=ss;function fs(t,e,n,r){let o;const i=[...t.tags??[],["e",e.id,n],["p",e.pubkey]];return e.kind===Ar?o=Ur:(o=Nr,i.push(["k",String(e.kind)])),gr({kind:o,tags:i,content:""===t.content||e.tags?.find(t=>"-"===t[0])?"":JSON.stringify(e),created_at:t.created_at},r)}function hs(t){if(![Ur,Nr].includes(t.kind))return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e?{id:e[1],relays:[e[2],n?.[2]].filter(t=>"string"==typeof t),author:n?.[1]}:void 0}function ds(t,{skipVerification:e}={}){const n=hs(t);if(void 0===n||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch(t){return}return r.id===n.id&&(e||pr(r))?r:void 0}Xn({},{finishRepostEvent:()=>fs,getRepostedEvent:()=>ds,getRepostedEventPointer:()=>hs}),Xn({},{NOSTR_URI_REGEX:()=>gs,parse:()=>ys,test:()=>ps});var gs=new RegExp(`nostr:(${li.source})`);function ps(t){return"string"==typeof t&&new RegExp(`^${gs.source}$`).test(t)}function ys(t){const e=t.match(new RegExp(`^${gs.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:hi(e[1])}}function ws(t,e,n){const r=e.tags.filter(t=>t.length>=2&&("e"===t[0]||"p"===t[0]));return gr({...t,kind:Lr,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function ms(t){if(t.kind!==Lr)return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e&&void 0!==n?{id:e[1],relays:[e[2],n[2]].filter(t=>void 0!==t),author:n[1]}:void 0}Xn({},{finishReactionEvent:()=>ws,getReactedEventPointer:()=>ms}),Xn({},{parse:()=>vs});var bs=/\W/m,Es=/\W |\W$|$|,| /m;function*vs(t){const e=t.length;let n=0,r=0;for(;r<e;){let o=t.indexOf(":",r);if(-1===o)break;if("nostr"===t.substring(o-5,o)){const i=t.substring(o+60).match(bs),s=i?o+60+i.index:e;try{let e,{data:i,type:a}=hi(t.substring(o+1,s));switch(a){case"npub":e={pubkey:i};break;case"nsec":case"note":r=s+1;continue;default:e=i}n!==o-5&&(yield{type:"text",text:t.substring(n,o-5)}),yield{type:"reference",pointer:e},r=s,n=r;continue}catch(t){r=o+1;continue}}else if("https"===t.substring(o-5,o)||"http"===t.substring(o-4,o)){const i=t.substring(o+4).match(Es),s=i?o+4+i.index:e,a="s"===t[o-1]?5:4;try{let e=new URL(t.substring(o-a,s));if(-1===e.hostname.indexOf("."))throw new Error("invalid url");if(n!==o-a&&(yield{type:"text",text:t.substring(n,o-a)}),e.pathname.endsWith(".png")||e.pathname.endsWith(".jpg")||e.pathname.endsWith(".jpeg")||e.pathname.endsWith(".gif")||e.pathname.endsWith(".webp")){yield{type:"image",url:e.toString()},r=s,n=r;continue}if(e.pathname.endsWith(".mp4")||e.pathname.endsWith(".avi")||e.pathname.endsWith(".webm")||e.pathname.endsWith(".mkv")){yield{type:"video",url:e.toString()},r=s,n=r;continue}if(e.pathname.endsWith(".mp3")||e.pathname.endsWith(".aac")||e.pathname.endsWith(".ogg")||e.pathname.endsWith(".opus")){yield{type:"audio",url:e.toString()},r=s,n=r;continue}yield{type:"url",url:e.toString()},r=s,n=r;continue}catch(t){r=s+1;continue}}else{if("wss"!==t.substring(o-3,o)&&"ws"!==t.substring(o-2,o)){r=o+1;continue}{const i=t.substring(o+4).match(Es),s=i?o+4+i.index:e,a="s"===t[o-1]?3:2;try{let e=new URL(t.substring(o-a,s));if(-1===e.hostname.indexOf("."))throw new Error("invalid ws url");n!==o-a&&(yield{type:"text",text:t.substring(n,o-a)}),yield{type:"relay",url:e.toString()},r=s,n=r;continue}catch(t){r=s+1;continue}}}}n!==e&&(yield{type:"text",text:t.substring(n)})}Xn({},{channelCreateEvent:()=>xs,channelHideMessageEvent:()=>Bs,channelMessageEvent:()=>Is,channelMetadataEvent:()=>As,channelMuteUserEvent:()=>Ss});var xs=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return gr({kind:Pr,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},As=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return gr({kind:$r,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Is=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),gr({kind:Or,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},Bs=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return gr({kind:Mr,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Ss=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return gr({kind:_r,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)};Xn({},{EMOJI_SHORTCODE_REGEX:()=>Ls,matchAll:()=>Cs,regex:()=>Ts,replaceAll:()=>Rs});var ks,Us,Ls=/:(\w+):/,Ts=()=>new RegExp(`\\B${Ls.source}\\B`,"g");function*Cs(t){const e=t.matchAll(Ts());for(const t of e)try{const[e,n]=t;yield{shortcode:e,name:n,start:t.index,end:t.index+e.length}}catch(t){}}function Rs(t,e){return t.replaceAll(Ts(),(t,n)=>e({shortcode:t,name:n}))}Xn({},{useFetchImplementation:()=>Ns,validateGithub:()=>Ps});try{ks=fetch}catch{}function Ns(t){ks=t}async function Ps(t,e,n){try{return await(await ks(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch(t){return!1}}function $s(t){const{host:e,pathname:n,searchParams:r}=new URL(t),o=n||e,i=r.get("relay"),s=r.get("secret");if(!o||!i||!s)throw new Error("invalid connection string");return{pubkey:o,relay:i,secret:s}}async function Os(t,e,n){const r={method:"pay_invoice",params:{invoice:n}},o=Ai(e,t,JSON.stringify(r)),i={kind:wo,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return gr(i,e)}function Ms(t){return t=(t=t.trim().toLowerCase()).normalize("NFKC"),Array.from(t).map(t=>/\p{Letter}/u.test(t)||/\p{Number}/u.test(t)?t:"-").join("")}Xn({},{makeNwcRequestEvent:()=>Os,parseConnectionString:()=>$s}),Xn({},{normalizeIdentifier:()=>Ms}),Xn({},{getSatoshisAmountFromBolt11:()=>Fs,getZapEndpoint:()=>Hs,makeZapReceipt:()=>Ds,makeZapRequest:()=>qs,useFetchImplementation:()=>_s,validateZapRequest:()=>zs});try{Us=fetch}catch{}function _s(t){Us=t}async function Hs(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(n){let{words:t}=Le.decode(n,1e3),r=Le.fromWords(t);e=nr.decode(r)}else{if(!r)return null;{let[t,n]=r.split("@");e=new URL(`/.well-known/lnurlp/${t}`,`https://${n}`).toString()}}let o=await Us(e),i=await o.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(t){}return null}function qs(t){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(e.tags.push(["e",t.event.id]),wr(t.event.kind)){const n=["a",`${t.event.kind}:${t.event.pubkey}:`];e.tags.push(n)}else if(br(t.event.kind)){let n=t.event.tags.find(([t,e])=>"d"===t&&e);if(!n)throw new Error("d tag not found or is empty");const r=["a",`${t.event.kind}:${t.event.pubkey}:${n[1]}`];e.tags.push(r)}e.tags.push(["k",t.event.kind.toString()])}return e}function zs(t){let e;try{e=JSON.parse(t)}catch(t){return"Invalid zap request JSON."}if(!er(e))return"Zap request is not a valid Nostr event.";if(!pr(e))return"Invalid signature on zap request.";let n=e.tags.find(([t,e])=>"p"===t&&e);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find(([t,e])=>"e"===t&&e);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([t,e])=>"relays"===t&&e)?null:"Zap request doesn't have a 'relays' tag."}function Ds({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),i=o.tags.filter(([t])=>"e"===t||"p"===t||"a"===t),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&s.tags.push(["preimage",e]),s}function Fs(t){if(t.length<50)return 0;const e=(t=t.substring(0,50)).lastIndexOf("1");if(-1===e)return 0;const n=t.substring(0,e);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],i=o.charCodeAt(0)-"0".charCodeAt(0),s=i>=0&&i<=9;let a=r.length-1;if(s&&a++,a<1)return 0;const c=parseInt(r.substring(0,a));switch(o){case"m":return 1e5*c;case"u":return 100*c;case"n":return c/10;case"p":return c/1e4;default:return 1e8*c}}Xn({},{getToken:()=>js,hashPayload:()=>Qs,unpackEventFromToken:()=>Ws,validateEvent:()=>ta,validateEventKind:()=>Zs,validateEventMethodTag:()=>Gs,validateEventPayloadTag:()=>Xs,validateEventTimestamp:()=>Js,validateEventUrlTag:()=>Ys,validateToken:()=>Vs});var Ks="Nostr ";async function js(t,e,n,r=!1,o){const i={kind:Eo,tags:[["u",t],["method",e]],created_at:Math.round((new Date).getTime()/1e3),content:""};o&&i.tags.push(["payload",Qs(o)]);const s=await n(i);return(r?Ks:"")+xe.encode(rr.encode(JSON.stringify(s)))}async function Vs(t,e,n){const r=await Ws(t).catch(t=>{throw t});return await ta(r,e,n).catch(t=>{throw t})}async function Ws(t){if(!t)throw new Error("Missing token");t=t.replace(Ks,"");const e=nr.decode(xe.decode(t));if(!e||0===e.length||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function Js(t){return!!t.created_at&&Math.round((new Date).getTime()/1e3)-t.created_at<60}function Zs(t){return t.kind===Eo}function Ys(t,e){const n=t.tags.find(t=>"u"===t[0]);return!!n&&n.length>0&&n[1]===e}function Gs(t,e){const n=t.tags.find(t=>"method"===t[0]);return!!n&&n.length>0&&n[1].toLowerCase()===e.toLowerCase()}function Qs(t){return jt(ue(rr.encode(JSON.stringify(t))))}function Xs(t,e){const n=t.tags.find(t=>"payload"===t[0]);if(!n)return!1;const r=Qs(e);return n.length>0&&n[1]===r}async function ta(t,e,n,r){if(!pr(t))throw new Error("Invalid nostr event, signature invalid");if(!Zs(t))throw new Error("Invalid nostr event, kind invalid");if(!Js(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!Ys(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!Gs(t,n))throw new Error("Invalid nostr event, method tag invalid");if(Boolean(r)&&"object"==typeof r&&Object.keys(r).length>0&&!Xs(t,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=n(938),e=n(583),r=n(185),o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})};const i=document.getElementById("nofferInput"),s=document.getElementById("decodeOfferButton"),a=document.getElementById("offer-actions"),c=document.getElementById("amountInput"),u=document.getElementById("getInvoiceButton"),l=document.getElementById("offer-result-section"),f=document.getElementById("result-header"),h=document.getElementById("result-data"),d=document.getElementById("qr-placeholder"),g=document.getElementById("qrCanvas"),p=document.getElementById("lnAddressInput"),y=document.getElementById("checkAddressButton"),w=document.getElementById("address-result-section"),m=document.getElementById("address-result-header"),b=document.getElementById("address-result-data"),E="noffer1qvqsyqjqxuurvwpcxc6rvvrxxsurqep5vfjk2wf4v33nsenrxumnyvesxfnrswfkvycrwdp3x93xydf5xg6rzce4vv6xgdfh8quxgct9x5erxvspremhxue69uhhgetnwskhyetvv9ujumrfva58gmnfdenjuur4vgqzpccxc30wpf78wf2q78wg3vq008fd8ygtl4qy06gstpye3h5unc47xmee6z",v=new t.lo;let x=null,A=!1;function I(){l.style.display="none",s.style.display="block",a.style.display="none",g.style.display="none",d.style.display="block",x=null,A=!1,s.textContent="Decode Offer",i.disabled=!1}function B(){l.scrollIntoView({behavior:"smooth",block:"center"})}const S=()=>{const e=i.value.trim();if(e){l.style.display="block",d.style.display="none",g.style.display="none";try{const n=(0,t._I)(e);if("noffer"!==n.type)throw new Error("Invalid string: Expected an 'noffer'.");x=n.data,f.textContent="Decoded Offer",h.textContent=JSON.stringify(x,null,2),s.style.display="none",a.style.display="block"}catch(t){console.error("Error decoding offer:",t),f.textContent="Error",h.textContent=`${t instanceof Error?t.message:String(t)}`,s.style.display="block",a.style.display="none",d.style.display="block"}setTimeout(B,100)}else alert("Please provide an offer string.")};s.addEventListener("click",()=>{if(A)i.value=E,I();else{let t=i.value.trim();!t&&i.placeholder&&(t=i.placeholder.trim(),i.value=t),S()}}),u.addEventListener("click",()=>o(void 0,void 0,void 0,function*(){if(x){i.disabled=!0,a.style.display="none",f.textContent="Invoice",h.textContent="Requesting invoice...";try{const n=c.value?parseInt(c.value,10):void 0,o=yield(0,t.u2)(v,r.c,[x.relay],x.pubkey,{offer:x.offer,amount_sats:n});"bolt11"in o&&"string"==typeof o.bolt11?(h.textContent=o.bolt11,g.style.display="block",e.toCanvas(g,o.bolt11.toUpperCase(),{width:256,margin:1})):(f.textContent="Error Response",h.textContent=JSON.stringify(o,null,2))}catch(t){console.error("Error getting invoice:",t),f.textContent="Error",h.textContent=`Error: ${t instanceof Error?t.message:String(t)}`}finally{A=!0,s.textContent="Reset",s.style.display="block",B()}}else alert("Offer data is missing. Please decode a new offer first.")})),i.addEventListener("input",I),y.addEventListener("click",function(){return o(this,void 0,void 0,function*(){var t;let e=p.value.trim();if(!e&&p.placeholder&&(e=p.placeholder.trim(),p.value=e),!e||!e.includes("@"))return void alert("Please enter a valid Lightning address (e.g., alice@example.com)");const[n,r]=e.split("@"),o=`https://${r}/.well-known/nostr.json?name=${encodeURIComponent(n)}`;m.textContent="Checking",b.textContent=`GET ${o}`,w.style.display="block";try{const e=yield fetch(o,{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`HTTP ${e.status}`);const r=yield e.json();let s=null;"string"==typeof r.clink_offer?s=r.clink_offer:r.clink_offer&&"object"==typeof r.clink_offer&&(s=null!==(t=r.clink_offer[n])&&void 0!==t?t:null),s?(m.textContent="CLINK Enabled ",i.value=s,S()):m.textContent="No CLINK Offer Found",b.textContent=JSON.stringify(r,null,2)}catch(t){console.error("Address check failed:",t),m.textContent="Error",b.textContent=`${t instanceof Error?t.message:String(t)}`}setTimeout(()=>{w.scrollIntoView({behavior:"smooth",block:"center"})},100)})}),i.value=E,I()})()})();